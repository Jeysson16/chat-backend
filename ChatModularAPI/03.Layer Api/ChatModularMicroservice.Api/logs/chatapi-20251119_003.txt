[2025-11-19 09:48:30.007 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 09:48:30.046 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 09:48:30.102 -05:00 ERR] Hosting failed to start {"EventId":{"Id":11,"Name":"HostedServiceStartupFaulted"},"SourceContext":"Microsoft.Extensions.Hosting.Internal.Host"}
System.IO.IOException: Failed to bind to address http://127.0.0.1:5405: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
 ---> System.Net.Sockets.SocketException (10048): Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
[2025-11-19 09:48:30.119 -05:00 FTL] La aplicación falló al iniciar {}
System.IO.IOException: Failed to bind to address http://127.0.0.1:5405: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
 ---> System.Net.Sockets.SocketException (10048): Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
   at Microsoft.Extensions.Hosting.Internal.Host.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.RunAsync(IHost host, CancellationToken token)
   at Microsoft.Extensions.Hosting.HostingAbstractionsHostExtensions.Run(IHost host)
   at Program.Main(String[] args) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Program.cs:line 190
[2025-11-19 09:54:23.315 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 09:54:23.349 -05:00 INF] Servidor escuchando en: http://localhost:5005;https://localhost:5006 {}
[2025-11-19 09:55:36.889 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q1:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q1"}
[2025-11-19 09:55:36.902 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q1:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q1"}
[2025-11-19 09:55:36.906 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q1:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q1"}
[2025-11-19 09:55:36.909 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q1:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q1"}
[2025-11-19 09:56:51.056 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"username":"testuser","password":"***"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7FEPDN9Q2:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7FEPDN9Q2"}
[2025-11-19 09:56:51.065 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q2:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7FEPDN9Q2"}
[2025-11-19 09:56:51.067 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q2:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7FEPDN9Q2"}
[2025-11-19 09:56:51.069 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q2:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7FEPDN9Q2"}
[2025-11-19 09:56:51.072 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q2:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7FEPDN9Q2"}
[2025-11-19 09:56:56.378 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.379 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.380 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.382 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.384 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.386 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.388 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.390 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.393 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
[2025-11-19 09:56:56.394 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
[2025-11-19 09:56:56.396 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
[2025-11-19 09:56:56.397 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
[2025-11-19 09:56:56.399 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
[2025-11-19 09:56:56.401 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
[2025-11-19 09:56:56.403 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
[2025-11-19 09:56:56.405 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
[2025-11-19 09:56:56.433 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
[2025-11-19 09:56:56.433 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.433 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
[2025-11-19 09:56:56.446 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"ae940bb6-db33-4794-9bf3-a61b876f36aa","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7FEPDN9Q3:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7FEPDN9Q3"}
[2025-11-19 09:56:56.462 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_qfN26ASV8vm3MywQ4PRWQ","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.465 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_qfN26ASV8vm3MywQ4PRWQ","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.467 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_qfN26ASV8vm3MywQ4PRWQ","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7FEPDN9Q4"}
[2025-11-19 09:56:56.470 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection _qfN26ASV8vm3MywQ4PRWQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_qfN26ASV8vm3MywQ4PRWQ","RequestId":"0HNH7FEPDN9Q4:00000001","RequestPath":"/chathub"}
[2025-11-19 09:56:58.429 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"cfc9f366-cc82-484e-b205-25060d6c49f4","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\SupabaseContactoRepository.cs:line 144
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 09:56:58.429 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"cd711197-fbe8-4fa3-8983-6cb36a066820","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\SupabaseContactoRepository.cs:line 144
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 09:56:58.449 -05:00 ERR] Error en controlador: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"cfc9f366-cc82-484e-b205-25060d6c49f4","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7FEPDN9Q6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7FEPDN9Q6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\SupabaseContactoRepository.cs:line 144
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 09:56:58.453 -05:00 ERR] Error en controlador: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"cd711197-fbe8-4fa3-8983-6cb36a066820","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7FEPDN9Q5:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7FEPDN9Q5"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"PGRST202","details":"Searched for the function public.USP_Contactos_ListarContactos with parameters p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id or with a single unnamed json/jsonb parameter, but no matches were found in the schema cache.","hint":"Perhaps you meant to call the function public.usp_contactos_listarcontactos","message":"Could not find the function public.USP_Contactos_ListarContactos(p_aplicacion_id, p_empresa_id, p_estado, p_usuario_id) in the schema cache"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\SupabaseContactoRepository.cs:line 144
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 10:02:37.473 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:02:37.519 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 10:03:08.186 -05:00 INF] HTTP Request - Method: POST, Path: /api/Contacto/ListarContactosPorUsuario, Body: {"usuarioId":"usuario1","empresaId":"empresa1","aplicacionId":"app1"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7FIVTCTMD:00000001","RequestPath":"/api/Contacto/ListarContactosPorUsuario","ConnectionId":"0HNH7FIVTCTMD"}
[2025-11-19 10:03:08.197 -05:00 INF] Verificando ruta: /api/Contacto/ListarContactosPorUsuario {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTMD:00000001","RequestPath":"/api/Contacto/ListarContactosPorUsuario","ConnectionId":"0HNH7FIVTCTMD"}
[2025-11-19 10:03:08.201 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTMD:00000001","RequestPath":"/api/Contacto/ListarContactosPorUsuario","ConnectionId":"0HNH7FIVTCTMD"}
[2025-11-19 10:03:08.204 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTMD:00000001","RequestPath":"/api/Contacto/ListarContactosPorUsuario","ConnectionId":"0HNH7FIVTCTMD"}
[2025-11-19 10:03:08.206 -05:00 INF] Ruta privada detectada: /api/Contacto/ListarContactosPorUsuario {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTMD:00000001","RequestPath":"/api/Contacto/ListarContactosPorUsuario","ConnectionId":"0HNH7FIVTCTMD"}
[2025-11-19 10:03:25.721 -05:00 INF] HTTP Request - Method: POST, Path: /api/Auth/Login, Body: {"email":"test@example.com","password":"***"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7FIVTCTME:00000001","RequestPath":"/api/Auth/Login","ConnectionId":"0HNH7FIVTCTME"}
[2025-11-19 10:03:25.725 -05:00 INF] Verificando ruta: /api/Auth/Login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTME:00000001","RequestPath":"/api/Auth/Login","ConnectionId":"0HNH7FIVTCTME"}
[2025-11-19 10:03:25.727 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTME:00000001","RequestPath":"/api/Auth/Login","ConnectionId":"0HNH7FIVTCTME"}
[2025-11-19 10:03:25.731 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTME:00000001","RequestPath":"/api/Auth/Login","ConnectionId":"0HNH7FIVTCTME"}
[2025-11-19 10:03:25.734 -05:00 INF] Ruta privada detectada: /api/Auth/Login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7FIVTCTME:00000001","RequestPath":"/api/Auth/Login","ConnectionId":"0HNH7FIVTCTME"}
[2025-11-19 10:10:14.934 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:10:14.969 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 10:23:31.454 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:23:31.490 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 10:24:17.962 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:24:17.998 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 10:29:13.713 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:29:13.749 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 10:58:51.277 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 10:58:51.321 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 10:59:26.451 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7GICD0EQ4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7GICD0EQ4"}
[2025-11-19 10:59:26.462 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7GICD0EQ4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7GICD0EQ4"}
[2025-11-19 10:59:26.465 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7GICD0EQ4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7GICD0EQ4"}
[2025-11-19 10:59:26.468 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7GICD0EQ4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7GICD0EQ4"}
[2025-11-19 11:26:20.982 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 11:26:21.021 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 11:28:57.465 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 11:28:57.506 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 11:32:57.733 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:57.734 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:57.733 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:57.734 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:57.738 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:57.739 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:57.740 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:57.742 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:57.744 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:57.745 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:57.746 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:57.748 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:57.750 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:57.752 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:57.754 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:57.756 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:58.353 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:58.353 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:58.353 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:58.539 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGO:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGO"}
[2025-11-19 11:32:58.698 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:58.698 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:58.699 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"lb0kdvyqygk_8rHth73pFw","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:58.708 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:32:58.711 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:32:58.716 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"lb0kdvyqygk_8rHth73pFw","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:58.722 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"lb0kdvyqygk_8rHth73pFw","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGN"}
[2025-11-19 11:32:58.726 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection lb0kdvyqygk_8rHth73pFw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"lb0kdvyqygk_8rHth73pFw","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub"}
[2025-11-19 11:33:00.740 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:33:00.746 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:33:00.757 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
[2025-11-19 11:33:00.759 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGM:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGM"}
[2025-11-19 11:33:00.763 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:33:00.798 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGP:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGP"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:46:09.850 -05:00 INF] Verificando ruta: /api/v1/contactos {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGR:00000001","RequestPath":"/api/v1/contactos","ConnectionId":"0HNH7H5648HGR"}
[2025-11-19 11:46:09.853 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGR:00000001","RequestPath":"/api/v1/contactos","ConnectionId":"0HNH7H5648HGR"}
[2025-11-19 11:46:09.856 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGR:00000001","RequestPath":"/api/v1/contactos","ConnectionId":"0HNH7H5648HGR"}
[2025-11-19 11:46:09.858 -05:00 INF] Ruta privada detectada: /api/v1/contactos {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGR:00000001","RequestPath":"/api/v1/contactos","ConnectionId":"0HNH7H5648HGR"}
[2025-11-19 11:47:34.377 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection lb0kdvyqygk_8rHth73pFw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"lb0kdvyqygk_8rHth73pFw","RequestId":"0HNH7H5648HGN:00000001","RequestPath":"/chathub"}
[2025-11-19 11:47:34.676 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.678 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.679 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.680 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.681 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.683 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.685 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.687 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.688 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.689 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.692 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.692 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGS:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HGS"}
[2025-11-19 11:47:34.695 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.697 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.702 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.704 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.705 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.707 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.709 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.711 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.715 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.715 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.717 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:47:34.720 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:34.750 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qo7Vx4hOZakjP_4WQ24E7Q","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.753 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qo7Vx4hOZakjP_4WQ24E7Q","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.756 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qo7Vx4hOZakjP_4WQ24E7Q","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HGT"}
[2025-11-19 11:47:34.762 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection qo7Vx4hOZakjP_4WQ24E7Q {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qo7Vx4hOZakjP_4WQ24E7Q","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub"}
[2025-11-19 11:47:35.524 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:47:35.541 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
[2025-11-19 11:47:35.546 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:47:35.549 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGU:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HGU"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:47:35.566 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:47:35.570 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HGV:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HGV"}
[2025-11-19 11:52:42.517 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection qo7Vx4hOZakjP_4WQ24E7Q {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qo7Vx4hOZakjP_4WQ24E7Q","RequestId":"0HNH7H5648HGT:00000001","RequestPath":"/chathub"}
[2025-11-19 11:52:42.842 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.844 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.845 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.845 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.847 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.849 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.850 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.853 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.854 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.855 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.857 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:52:42.859 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.863 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.865 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.867 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.868 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.870 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.871 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.872 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.875 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.876 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.879 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:52:42.881 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.886 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:42.917 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"yQ8WUTUblVIf0rVMsr6e7w","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.920 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"yQ8WUTUblVIf0rVMsr6e7w","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.922 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"yQ8WUTUblVIf0rVMsr6e7w","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH1"}
[2025-11-19 11:52:42.924 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection yQ8WUTUblVIf0rVMsr6e7w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"yQ8WUTUblVIf0rVMsr6e7w","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub"}
[2025-11-19 11:52:43.281 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:52:43.285 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:52:43.288 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:52:43.293 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH3"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:52:43.418 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:52:43.421 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.622 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection yQ8WUTUblVIf0rVMsr6e7w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"yQ8WUTUblVIf0rVMsr6e7w","RequestId":"0HNH7H5648HH1:00000001","RequestPath":"/chathub"}
[2025-11-19 11:54:11.927 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.929 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.931 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.932 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:11.933 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.934 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:11.936 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.938 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:11.939 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.940 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:54:11.942 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:11.943 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.947 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.951 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.953 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.954 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.956 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.958 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.959 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.961 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.962 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.965 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:11.967 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:11.971 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:12.004 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"A0Inx3i8AoYj4l33ZQMt1w","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:12.007 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"A0Inx3i8AoYj4l33ZQMt1w","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:12.009 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"A0Inx3i8AoYj4l33ZQMt1w","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH4"}
[2025-11-19 11:54:12.011 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection A0Inx3i8AoYj4l33ZQMt1w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"A0Inx3i8AoYj4l33ZQMt1w","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub"}
[2025-11-19 11:54:12.296 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:54:12.300 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:54:12.540 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:54:12.548 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:54:12.551 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:54:12.555 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH0"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:55:10.380 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection A0Inx3i8AoYj4l33ZQMt1w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"A0Inx3i8AoYj4l33ZQMt1w","RequestId":"0HNH7H5648HH4:00000001","RequestPath":"/chathub"}
[2025-11-19 11:55:10.657 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.659 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.660 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.663 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.661 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.666 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.668 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.670 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.671 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.673 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.697 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH0:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH0"}
[2025-11-19 11:55:10.694 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.674 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.703 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.705 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.710 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.707 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.713 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.715 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.718 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.721 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.723 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.725 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:10.727 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:10.740 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E2ZJ-_EwgJe8t6KH-DdMQg","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.743 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E2ZJ-_EwgJe8t6KH-DdMQg","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.745 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E2ZJ-_EwgJe8t6KH-DdMQg","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH5"}
[2025-11-19 11:55:10.748 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection E2ZJ-_EwgJe8t6KH-DdMQg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E2ZJ-_EwgJe8t6KH-DdMQg","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub"}
[2025-11-19 11:55:11.291 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:55:11.299 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH3:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH3"}
[2025-11-19 11:55:11.299 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 11:55:11.304 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
[2025-11-19 11:55:11.308 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 11:55:11.312 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH2:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH2"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:10:12.979 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection E2ZJ-_EwgJe8t6KH-DdMQg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E2ZJ-_EwgJe8t6KH-DdMQg","RequestId":"0HNH7H5648HH5:00000001","RequestPath":"/chathub"}
[2025-11-19 12:10:13.270 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.272 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.273 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.274 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.276 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.278 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.279 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.282 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.284 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.284 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.287 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.290 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HH6"}
[2025-11-19 12:10:13.291 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.291 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.296 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.297 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.299 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.301 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.302 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.304 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.306 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.308 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:13.310 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.314 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:13.352 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9MIW-Vck17noaQ9GelRzcw","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.355 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9MIW-Vck17noaQ9GelRzcw","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.357 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9MIW-Vck17noaQ9GelRzcw","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HH7"}
[2025-11-19 12:10:13.360 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection 9MIW-Vck17noaQ9GelRzcw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9MIW-Vck17noaQ9GelRzcw","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub"}
[2025-11-19 12:10:14.227 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:10:14.229 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:10:14.231 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
[2025-11-19 12:10:14.234 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH9:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HH9"}
[2025-11-19 12:10:14.236 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:10:14.242 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HH8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HH8"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:35:21.118 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection 9MIW-Vck17noaQ9GelRzcw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9MIW-Vck17noaQ9GelRzcw","RequestId":"0HNH7H5648HH7:00000001","RequestPath":"/chathub"}
[2025-11-19 12:35:21.416 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.418 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.420 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.420 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.422 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.423 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.425 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.426 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.446 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.432 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHA"}
[2025-11-19 12:35:21.444 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.451 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.432 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.455 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.457 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.458 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.460 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.462 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.464 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.466 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.467 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.469 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:21.471 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.475 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:21.501 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rBifVSiYcUvK_4610SH_fQ","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.503 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rBifVSiYcUvK_4610SH_fQ","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.506 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rBifVSiYcUvK_4610SH_fQ","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHB"}
[2025-11-19 12:35:21.508 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection rBifVSiYcUvK_4610SH_fQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rBifVSiYcUvK_4610SH_fQ","RequestId":"0HNH7H5648HHB:00000001","RequestPath":"/chathub"}
[2025-11-19 12:35:22.608 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:35:22.611 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:35:22.618 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHD:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHD"}
[2025-11-19 12:35:22.621 -05:00 WRN] No se encontraron contactos para el usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
[2025-11-19 12:35:22.626 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:35:22.629 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHC:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHC"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:40:12.587 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/register, Body: {"cUsuariosNombre":"José Santillan","cUsuariosEmail":"josantillan@gmail.com","cUsuariosCodigo":"José Santillan","cUsuariosPassword":"josanti12345","cUsuariosConfirmarPassword":"josanti12345","cUsuariosPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:12.594 -05:00 INF] Verificando ruta: /api/v1/auth/register {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:12.596 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:12.599 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:12.602 -05:00 INF] Ruta pública detectada: /api/v1/auth/register {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:12.682 -05:00 INF] GetByEmailAsync: Buscando usuario por email: josantillan@gmail.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:13.457 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: josantillan@gmail.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:13.462 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:13.666 -05:00 INF] GetByUsernameAsync: Usuario no encontrado por username: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:13.876 -05:00 INF] Creando usuario en Supabase: josantillan@gmail.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.110 -05:00 INF] Generando ID para usuario: 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.115 -05:00 INF] Insertando usuario en Supabase con ID: 1000000003, Email: josantillan@gmail.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.356 -05:00 INF] Respuesta de Supabase: "Created" {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.370 -05:00 INF] Generating access token for user 1000000003 with role: USER {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.381 -05:00 INF] Generated token with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:14.385 -05:00 INF] Usuario registrado exitosamente: josantillan@gmail.com {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"31f83fbe-6f72-4ef5-8656-b1be1079a966","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Register (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000002","RequestPath":"/api/v1/auth/register","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:23.743 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JOSANTI","cUsuarioContra":"josanti12345","bRecordarme":false,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:23.752 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:23.754 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:23.757 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:23.759 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.158 -05:00 INF] Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.172 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.322 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.520 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.526 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.671 -05:00 INF] GetByUsernameAsync: Usuario no encontrado por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.691 -05:00 INF] Resultado búsqueda usuario: encontrado=false {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:24.693 -05:00 WRN] Login fallido: usuario no encontrado o inactivo. cUsuarioCodigo=JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.357 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JOSANTI","cUsuarioContra":"josanti12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.361 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.363 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.365 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.367 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.660 -05:00 INF] Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.663 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.819 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.968 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:31.974 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:32.128 -05:00 INF] GetByUsernameAsync: Usuario no encontrado por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:32.138 -05:00 INF] Resultado búsqueda usuario: encontrado=false {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:40:32.140 -05:00 WRN] Login fallido: usuario no encontrado o inactivo. cUsuarioCodigo=JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000006","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.541 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JOSANTI","cUsuarioContra":"josanti12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.547 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.550 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.553 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.555 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.935 -05:00 INF] Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:06.941 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.111 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.258 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.261 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.419 -05:00 INF] GetByUsernameAsync: Usuario no encontrado por username: JOSANTI {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.426 -05:00 INF] Resultado búsqueda usuario: encontrado=false {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:41:07.428 -05:00 WRN] Login fallido: usuario no encontrado o inactivo. cUsuarioCodigo=JOSANTI {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:00000008","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:12.454 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"José Santillan","cUsuarioContra":"josanti12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:12.457 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:12.460 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:12.462 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:12.464 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.148 -05:00 INF] Buscando usuario por código: José Santillan {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.153 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.342 -05:00 INF] GetByEmailAsync: Buscando usuario por email: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.483 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.488 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: José Santillan {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.655 -05:00 INF] GetByUsernameAsync: Usuario encontrado, rol asignado: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.663 -05:00 INF] GetByUserCodeAsync: Encontrado por Username, rol: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.666 -05:00 INF] Resultado búsqueda usuario: encontrado=true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.806 -05:00 INF] Validación de contraseña con BCrypt para usuario José Santillan: true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.813 -05:00 INF] Generating access token for user 1000000003 with role: USER {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:13.818 -05:00 INF] Generated token with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.160 -05:00 INF] Login exitoso para usuario: José Santillan {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"28ad18fb-46f8-4136-a066-50f2a2a34a63","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000A","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.240 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.244 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.245 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.248 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.251 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.252 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.254 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.256 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.259 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.261 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.264 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.266 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.268 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.270 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.272 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.276 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.277 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rU7lba6W25qeBxQzRodFUQ","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.278 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"c0dae95f-f063-4374-af88-d393ecb47b49","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHE:0000000C","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7H5648HHE"}
[2025-11-19 12:42:14.280 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.282 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.284 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rU7lba6W25qeBxQzRodFUQ","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.290 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.293 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.295 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rU7lba6W25qeBxQzRodFUQ","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7H5648HHF"}
[2025-11-19 12:42:14.298 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.301 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.303 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection rU7lba6W25qeBxQzRodFUQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"rU7lba6W25qeBxQzRodFUQ","RequestId":"0HNH7H5648HHF:00000001","RequestPath":"/chathub"}
[2025-11-19 12:42:14.306 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.454 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:42:14.458 -05:00 WRN] No se encontraron contactos para el usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"7d1f6074-3113-4d4d-aa72-c2fd05576c18","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:14.817 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 12:42:14.849 -05:00 WRN] No se encontraron contactos para el usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:14.854 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:42:14.857 -05:00 ERR] Error en controlador: ListarSolicitudesPendientesAsync aún no está implementado en Supabase {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"b04f0329-20e8-451b-8cbd-05c21e27b613","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7H5648HHG:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7H5648HHG"}
System.NotImplementedException: ListarSolicitudesPendientesAsync aún no está implementado en Supabase
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 79
   at ChatModularMicroservice.Domain.ContactoService.ListarSolicitudesPendientesAsync(String usuarioId, String empresaId, String aplicacionId) in D:\Chat\chatbackend\chatmodularapi\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 53
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Controllers\ContactoController.cs:line 328
[2025-11-19 12:42:19.967 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"Jeys","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:19.968 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000003","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:19.975 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:19.977 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000003","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:19.979 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:19.983 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000003","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:19.984 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:19.987 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000003","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:19.989 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:19.991 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHH:00000003","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7H5648HHH"}
[2025-11-19 12:42:19.992 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.000 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IUsuarioService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.UsuariosController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method416(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 12:42:20.011 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"Jeys","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.012 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.014 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.015 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.017 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.018 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
[2025-11-19 12:42:20.021 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7H5648HHG:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7H5648HHG"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IUsuarioService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.UsuariosController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method416(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\chatbackend\chatmodularapi\03.layer api\chatmodularmicroservice.api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 12:51:18.523 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 12:51:18.556 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 12:51:18.730 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.736 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.738 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.741 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.751 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.753 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.755 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.757 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.839 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6qTusPNmci6ofBUYbSPQkQ","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.839 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Snn9w3Ece95THs0fanCl6w","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.854 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Snn9w3Ece95THs0fanCl6w","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.854 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6qTusPNmci6ofBUYbSPQkQ","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.857 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Snn9w3Ece95THs0fanCl6w","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9D"}
[2025-11-19 12:51:18.860 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6qTusPNmci6ofBUYbSPQkQ","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IGV4HO9E"}
[2025-11-19 12:51:18.863 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection Snn9w3Ece95THs0fanCl6w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Snn9w3Ece95THs0fanCl6w","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub"}
[2025-11-19 12:51:18.864 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 6qTusPNmci6ofBUYbSPQkQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6qTusPNmci6ofBUYbSPQkQ","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub"}
[2025-11-19 12:51:18.898 -05:00 INF] Verificando ruta: / {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000001","RequestPath":"/","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.902 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000001","RequestPath":"/","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.906 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000001","RequestPath":"/","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.908 -05:00 INF] Ruta privada detectada: / {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000001","RequestPath":"/","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.984 -05:00 INF] Verificando ruta: /@vite/client {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000002","RequestPath":"/@vite/client","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.987 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000002","RequestPath":"/@vite/client","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.989 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000002","RequestPath":"/@vite/client","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:51:18.992 -05:00 INF] Ruta privada detectada: /@vite/client {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IGV4HO9F:00000002","RequestPath":"/@vite/client","ConnectionId":"0HNH7IGV4HO9F"}
[2025-11-19 12:58:37.373 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 6qTusPNmci6ofBUYbSPQkQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6qTusPNmci6ofBUYbSPQkQ","RequestId":"0HNH7IGV4HO9E:00000001","RequestPath":"/chathub"}
[2025-11-19 12:58:37.373 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection Snn9w3Ece95THs0fanCl6w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Snn9w3Ece95THs0fanCl6w","RequestId":"0HNH7IGV4HO9D:00000001","RequestPath":"/chathub"}
[2025-11-19 13:00:06.864 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 13:00:06.898 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 13:01:38.488 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.491 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.492 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.492 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.493 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.494 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.496 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.498 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.500 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.502 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.504 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.506 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.508 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.510 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.512 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.514 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.601 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.601 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.601 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.640 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.640 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:38.640 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.648 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:38.650 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVWddxDcQxHsCvsOxDq14A","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.653 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:38.659 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVWddxDcQxHsCvsOxDq14A","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.665 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVWddxDcQxHsCvsOxDq14A","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5M"}
[2025-11-19 13:01:38.669 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection NVWddxDcQxHsCvsOxDq14A {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVWddxDcQxHsCvsOxDq14A","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub"}
[2025-11-19 13:01:39.838 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:01:39.838 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:01:39.858 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:39.864 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:40.121 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:01:40.128 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:01:40.136 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:01:40.152 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:01:40.155 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:01:40.163 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:01:51.635 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000002","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:01:51.639 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000002","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:01:51.642 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000002","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:01:51.643 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"Jeyss","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:51.645 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000002","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:01:51.648 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:51.650 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000002","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:01:51.652 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:51.655 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:51.657 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:51.659 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000002","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:01:56.919 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection NVWddxDcQxHsCvsOxDq14A {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVWddxDcQxHsCvsOxDq14A","RequestId":"0HNH7IMNR0S5M:00000001","RequestPath":"/chathub"}
[2025-11-19 13:01:57.198 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.200 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.201 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.202 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.204 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.205 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.207 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.209 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.210 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.215 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.214 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5N:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5N"}
[2025-11-19 13:01:57.210 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.216 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.217 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.223 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.225 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.227 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.230 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.231 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.233 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.234 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.236 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.239 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.265 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.258 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CZPsyXrYt5BrmNtmUdd5Kw","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.273 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CZPsyXrYt5BrmNtmUdd5Kw","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.277 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CZPsyXrYt5BrmNtmUdd5Kw","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5R"}
[2025-11-19 13:01:57.281 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection CZPsyXrYt5BrmNtmUdd5Kw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CZPsyXrYt5BrmNtmUdd5Kw","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub"}
[2025-11-19 13:01:57.480 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:01:57.484 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:01:57.512 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:01:57.517 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:01:57.718 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:01:57.723 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:01:57.726 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5L:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5L"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:01:57.772 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:01:57.776 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:01:57.781 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5O:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:02:02.088 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"jey","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:02.094 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000007","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:02.097 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:02.100 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000007","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:02.105 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:02.109 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000007","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:02.112 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:02.115 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000007","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:02.117 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:02.119 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000007","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:02.121 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000005","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.859 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"jeys","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.865 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000009","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:03.868 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.870 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000009","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:03.872 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.874 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000009","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:03.877 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.881 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000009","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:03.885 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:02:03.887 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5L:00000009","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5L"}
[2025-11-19 13:02:03.889 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5O:00000006","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5O"}
[2025-11-19 13:03:17.915 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/usuarios/buscar, Body: {"cTerminoBusqueda":"Jeysso","nEmpresasId":"","nAplicacionesId":""} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:03:17.918 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000004","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:03:17.926 -05:00 INF] Verificando ruta: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:03:17.929 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000004","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:03:17.934 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:03:17.938 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000004","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:03:17.941 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:03:17.944 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000004","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:03:17.946 -05:00 INF] Ruta privada detectada: /api/v1/usuarios/buscar {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:03:17.949 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5P:00000004","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S5P"}
[2025-11-19 13:03:17.952 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5Q:00000004","RequestPath":"/api/v1/usuarios/buscar","ConnectionId":"0HNH7IMNR0S5Q"}
[2025-11-19 13:18:14.045 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection CZPsyXrYt5BrmNtmUdd5Kw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CZPsyXrYt5BrmNtmUdd5Kw","RequestId":"0HNH7IMNR0S5R:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:14.443 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.443 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.446 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.448 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.451 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.453 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.456 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.460 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.463 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.468 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:14.469 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.471 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.475 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.477 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.478 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.482 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.480 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.485 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.487 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.490 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.492 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.494 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:14.496 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.500 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:14.530 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"11xEtDWg9pcOvmVhorUVVQ","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.532 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"11xEtDWg9pcOvmVhorUVVQ","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.536 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"11xEtDWg9pcOvmVhorUVVQ","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S5T"}
[2025-11-19 13:18:14.538 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection 11xEtDWg9pcOvmVhorUVVQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"11xEtDWg9pcOvmVhorUVVQ","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:14.541 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.544 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.545 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.547 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.548 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.550 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.551 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.554 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.555 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.560 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.566 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.568 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.570 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.572 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.572 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.574 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.576 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.577 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.580 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.581 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.584 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:14.586 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.591 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.594 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:14.624 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"PArx7qzbc5cAonuxCBqMkw","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.628 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"PArx7qzbc5cAonuxCBqMkw","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.631 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"PArx7qzbc5cAonuxCBqMkw","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S61"}
[2025-11-19 13:18:14.633 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection PArx7qzbc5cAonuxCBqMkw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"PArx7qzbc5cAonuxCBqMkw","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:15.167 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:15.171 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:15.320 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:15.323 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:15.324 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:15.327 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:15.330 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:15.353 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:15.357 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:15.375 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:15.379 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:15.532 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:15.542 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:15.548 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:15.569 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:15.575 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:15.580 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:15.594 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:15.598 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:15.601 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:23.820 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection PArx7qzbc5cAonuxCBqMkw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"PArx7qzbc5cAonuxCBqMkw","RequestId":"0HNH7IMNR0S61:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:23.824 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection 11xEtDWg9pcOvmVhorUVVQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"11xEtDWg9pcOvmVhorUVVQ","RequestId":"0HNH7IMNR0S5T:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:24.265 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.267 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.270 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.273 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.275 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.277 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.279 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.281 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.283 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.286 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:24.290 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.291 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.294 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.296 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.298 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.300 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.301 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.303 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.305 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.307 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.309 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.310 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.313 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.313 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.315 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.317 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.324 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.325 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.325 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_lWsmvkGOX-TWkIE_AaSaA","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.327 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.329 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.331 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_lWsmvkGOX-TWkIE_AaSaA","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.333 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.333 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.333 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.335 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.337 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_lWsmvkGOX-TWkIE_AaSaA","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S63"}
[2025-11-19 13:18:24.340 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.342 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.344 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.347 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:24.349 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection _lWsmvkGOX-TWkIE_AaSaA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_lWsmvkGOX-TWkIE_AaSaA","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:24.355 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.357 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.364 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.365 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LjdeEu-TQrA9e4wZrc70dw","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.366 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.368 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.371 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LjdeEu-TQrA9e4wZrc70dw","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.374 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.377 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.379 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LjdeEu-TQrA9e4wZrc70dw","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S64"}
[2025-11-19 13:18:24.382 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.384 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.386 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection LjdeEu-TQrA9e4wZrc70dw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LjdeEu-TQrA9e4wZrc70dw","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:24.390 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.521 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:24.525 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:24.556 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:24.559 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:24.587 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:24.591 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:24.605 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:24.609 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:24.730 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:24.735 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:24.740 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:24.741 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:24.748 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:24.753 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:24.760 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:24.765 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:24.769 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:24.856 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:24.860 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:24.863 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S60"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:44.056 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection LjdeEu-TQrA9e4wZrc70dw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LjdeEu-TQrA9e4wZrc70dw","RequestId":"0HNH7IMNR0S64:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:44.061 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection _lWsmvkGOX-TWkIE_AaSaA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"_lWsmvkGOX-TWkIE_AaSaA","RequestId":"0HNH7IMNR0S63:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:44.486 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.497 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.500 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.510 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.510 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.510 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.502 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.514 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.516 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.518 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.521 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.523 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.525 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.528 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.530 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.534 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.536 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.539 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:18:44.540 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.543 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.545 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"tDQxCFOGWCa2jC9wYRCDHw","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.550 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.552 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.555 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"tDQxCFOGWCa2jC9wYRCDHw","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.558 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.561 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.564 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"tDQxCFOGWCa2jC9wYRCDHw","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S66"}
[2025-11-19 13:18:44.581 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection tDQxCFOGWCa2jC9wYRCDHw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"tDQxCFOGWCa2jC9wYRCDHw","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:44.717 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.719 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.722 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.725 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.728 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.729 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.731 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S60:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S60"}
[2025-11-19 13:18:44.732 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.735 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.738 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.739 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.741 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.743 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.745 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.748 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.752 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.755 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.757 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.760 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.762 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.764 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.766 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.769 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:44.769 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:44.772 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.776 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:18:44.785 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:44.785 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7R-APP1_BbqGcuM1TcjXTQ","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.790 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:18:44.793 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7R-APP1_BbqGcuM1TcjXTQ","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.798 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7R-APP1_BbqGcuM1TcjXTQ","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S67"}
[2025-11-19 13:18:44.801 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 7R-APP1_BbqGcuM1TcjXTQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7R-APP1_BbqGcuM1TcjXTQ","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub"}
[2025-11-19 13:18:44.934 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:44.940 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:18:44.982 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:44.987 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:44.992 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:45.000 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:45.001 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:18:45.004 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:45.008 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:18:45.012 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:45.081 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:45.085 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:45.090 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000007","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:18:45.218 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:18:45.221 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:18:45.225 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:20:42.264 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 7R-APP1_BbqGcuM1TcjXTQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7R-APP1_BbqGcuM1TcjXTQ","RequestId":"0HNH7IMNR0S67:00000001","RequestPath":"/chathub"}
[2025-11-19 13:20:42.268 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection tDQxCFOGWCa2jC9wYRCDHw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"tDQxCFOGWCa2jC9wYRCDHw","RequestId":"0HNH7IMNR0S66:00000001","RequestPath":"/chathub"}
[2025-11-19 13:20:42.670 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.673 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.676 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.680 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.693 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.697 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.700 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.701 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.712 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.754 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.759 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.762 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.763 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mh3xOarh3f8s4lkd6RQBOg","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.764 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.767 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.769 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.785 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mh3xOarh3f8s4lkd6RQBOg","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.789 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:20:42.799 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.808 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.820 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.818 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.812 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mh3xOarh3f8s4lkd6RQBOg","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S68"}
[2025-11-19 13:20:42.823 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.827 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.832 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection mh3xOarh3f8s4lkd6RQBOg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mh3xOarh3f8s4lkd6RQBOg","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub"}
[2025-11-19 13:20:42.835 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:42.839 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:42.908 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.910 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.914 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.917 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.920 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.924 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000005","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.927 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.930 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.932 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.935 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.936 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.940 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.940 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.942 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.944 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.946 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.948 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.950 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.952 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.954 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.956 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.958 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:42.962 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.969 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:42.984 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"-59xWbkApC8XHLEP3JGtYQ","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.991 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"-59xWbkApC8XHLEP3JGtYQ","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.995 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"-59xWbkApC8XHLEP3JGtYQ","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S69"}
[2025-11-19 13:20:42.998 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection -59xWbkApC8XHLEP3JGtYQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"-59xWbkApC8XHLEP3JGtYQ","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub"}
[2025-11-19 13:20:43.344 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:20:43.344 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:20:43.349 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:20:43.350 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:20:43.354 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:20:43.357 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:20:43.521 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:20:43.525 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:20:43.560 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:20:43.568 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:20:43.576 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:20:43.587 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:20:43.588 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:20:43.595 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:20:43.619 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:20:43.638 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:20:43.642 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:20:43.691 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:20:43.696 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:20:43.701 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:21:33.412 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection -59xWbkApC8XHLEP3JGtYQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"-59xWbkApC8XHLEP3JGtYQ","RequestId":"0HNH7IMNR0S69:00000001","RequestPath":"/chathub"}
[2025-11-19 13:21:33.416 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection mh3xOarh3f8s4lkd6RQBOg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mh3xOarh3f8s4lkd6RQBOg","RequestId":"0HNH7IMNR0S68:00000001","RequestPath":"/chathub"}
[2025-11-19 13:21:33.863 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.864 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.865 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.868 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.870 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.874 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.876 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.879 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.882 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.885 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:21:33.888 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.890 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.892 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.894 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.896 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.898 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.899 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.901 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.903 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.905 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.908 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.910 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.912 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:33.914 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:33.927 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"DDulGONcyTwNeEFA74h2uA","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.929 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"DDulGONcyTwNeEFA74h2uA","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.931 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"DDulGONcyTwNeEFA74h2uA","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6A"}
[2025-11-19 13:21:33.933 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection DDulGONcyTwNeEFA74h2uA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"DDulGONcyTwNeEFA74h2uA","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub"}
[2025-11-19 13:21:33.947 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.949 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.951 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.953 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.953 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:33.957 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.958 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:33.961 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000009","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:21:33.961 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.963 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:33.968 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.968 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.970 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:33.974 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.977 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.981 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.983 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.985 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.987 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.989 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.992 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.993 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:33.996 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:33.998 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:34.010 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0VXHIAb3ZV74TWTySW7dNw","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:34.013 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0VXHIAb3ZV74TWTySW7dNw","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:34.016 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0VXHIAb3ZV74TWTySW7dNw","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6B"}
[2025-11-19 13:21:34.018 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 0VXHIAb3ZV74TWTySW7dNw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0VXHIAb3ZV74TWTySW7dNw","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub"}
[2025-11-19 13:21:34.095 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:21:34.102 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:21:34.163 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:21:34.166 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:21:34.228 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:21:34.234 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:21:34.242 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:21:34.253 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:21:34.258 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:21:34.263 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:21:34.272 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:21:34.371 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:21:34.377 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:21:34.382 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:21:34.412 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:21:34.417 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:21:34.422 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:21:34.528 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:21:34.532 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:21:34.536 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6C"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:22:13.668 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 0VXHIAb3ZV74TWTySW7dNw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0VXHIAb3ZV74TWTySW7dNw","RequestId":"0HNH7IMNR0S6B:00000001","RequestPath":"/chathub"}
[2025-11-19 13:22:13.674 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection DDulGONcyTwNeEFA74h2uA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"DDulGONcyTwNeEFA74h2uA","RequestId":"0HNH7IMNR0S6A:00000001","RequestPath":"/chathub"}
[2025-11-19 13:22:14.059 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.061 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.065 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.067 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.086 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.086 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.088 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.090 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.092 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.094 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.097 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.099 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.101 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.104 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.106 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.108 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.110 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.112 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.114 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.116 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:22:14.117 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.119 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.125 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.128 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.133 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qxZhLCiN6YOTm9J7LMC2ew","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.136 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qxZhLCiN6YOTm9J7LMC2ew","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.141 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qxZhLCiN6YOTm9J7LMC2ew","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6D"}
[2025-11-19 13:22:14.143 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection qxZhLCiN6YOTm9J7LMC2ew {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qxZhLCiN6YOTm9J7LMC2ew","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub"}
[2025-11-19 13:22:14.179 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.180 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.182 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.184 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.186 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.186 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.189 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.192 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6C:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6C"}
[2025-11-19 13:22:14.194 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.195 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.198 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.199 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.202 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.204 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.220 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.211 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.229 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.231 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.233 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.235 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.238 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.242 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.245 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.249 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.260 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Vtjt07dP0K2HHxqoLMTnWw","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.263 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Vtjt07dP0K2HHxqoLMTnWw","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.266 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Vtjt07dP0K2HHxqoLMTnWw","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6E"}
[2025-11-19 13:22:14.268 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection Vtjt07dP0K2HHxqoLMTnWw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Vtjt07dP0K2HHxqoLMTnWw","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub"}
[2025-11-19 13:22:14.293 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:22:14.297 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:22:14.373 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:22:14.377 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:22:14.449 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:22:14.453 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:22:14.457 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:22:14.474 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:22:14.480 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:22:14.486 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:22:14.492 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:22:14.608 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:22:14.611 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:22:14.614 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5V"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:22:14.696 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:22:14.700 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:22:14.704 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000D","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:22:14.705 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:22:14.714 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:22:14.719 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:23:52.632 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection Vtjt07dP0K2HHxqoLMTnWw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"Vtjt07dP0K2HHxqoLMTnWw","RequestId":"0HNH7IMNR0S6E:00000001","RequestPath":"/chathub"}
[2025-11-19 13:23:52.635 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection qxZhLCiN6YOTm9J7LMC2ew {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qxZhLCiN6YOTm9J7LMC2ew","RequestId":"0HNH7IMNR0S6D:00000001","RequestPath":"/chathub"}
[2025-11-19 13:23:53.033 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.036 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.039 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.042 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.046 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.048 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.051 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.051 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.053 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.054 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.055 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.058 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.060 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.062 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.065 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5V:0000000F","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5V"}
[2025-11-19 13:23:53.066 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.068 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.074 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.076 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.078 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.080 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.081 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.084 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.087 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.096 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.099 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.100 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.103 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.105 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.105 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ABUfrSj_RCyGqnhOw_HlrQ","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.108 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.112 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.112 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ABUfrSj_RCyGqnhOw_HlrQ","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.142 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ABUfrSj_RCyGqnhOw_HlrQ","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6F"}
[2025-11-19 13:23:53.145 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection ABUfrSj_RCyGqnhOw_HlrQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ABUfrSj_RCyGqnhOw_HlrQ","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub"}
[2025-11-19 13:23:53.147 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.131 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.163 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.310 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.312 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.314 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.318 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.320 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.327 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.329 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.333 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.335 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.336 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LLWbXppzDpGpdnKauY3Mqg","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.337 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.341 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.345 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LLWbXppzDpGpdnKauY3Mqg","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.347 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.349 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.352 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LLWbXppzDpGpdnKauY3Mqg","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6G"}
[2025-11-19 13:23:53.356 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.364 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection LLWbXppzDpGpdnKauY3Mqg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LLWbXppzDpGpdnKauY3Mqg","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub"}
[2025-11-19 13:23:53.610 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:23:53.614 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:23:53.647 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:23:53.650 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:23:53.733 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:23:53.738 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:23:53.821 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:23:53.826 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:23:53.849 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:23:53.853 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:23:53.858 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:23:53.869 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:23:53.873 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:23:53.877 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:0000000D","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:23:53.976 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:23:53.983 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:23:53.990 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:0000000F","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:23:54.088 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:23:54.095 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:23:54.099 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:0000000F","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:24:28.928 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection LLWbXppzDpGpdnKauY3Mqg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"LLWbXppzDpGpdnKauY3Mqg","RequestId":"0HNH7IMNR0S6G:00000001","RequestPath":"/chathub"}
[2025-11-19 13:24:28.932 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection ABUfrSj_RCyGqnhOw_HlrQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ABUfrSj_RCyGqnhOw_HlrQ","RequestId":"0HNH7IMNR0S6F:00000001","RequestPath":"/chathub"}
[2025-11-19 13:24:29.331 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.334 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.337 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.338 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.341 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.343 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.343 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000F","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.347 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.349 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000F","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.350 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.352 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000F","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.354 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.357 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:0000000F","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.360 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000010","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.381 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.383 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.385 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.386 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000011","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.387 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.390 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000011","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.391 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.392 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.393 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000011","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.396 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000011","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.397 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.398 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000011","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.399 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"oOOh8SU1uPpZtd84qf7RQw","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.403 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.407 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"oOOh8SU1uPpZtd84qf7RQw","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.409 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.411 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"oOOh8SU1uPpZtd84qf7RQw","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6H"}
[2025-11-19 13:24:29.415 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection oOOh8SU1uPpZtd84qf7RQw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"oOOh8SU1uPpZtd84qf7RQw","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub"}
[2025-11-19 13:24:29.419 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.421 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.423 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.426 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.430 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.432 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.434 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.435 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.437 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.440 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.442 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.444 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.447 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.452 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.453 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.454 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.455 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6JXBKXFNvCzHYjHYmA75XA","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.457 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.458 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.462 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6JXBKXFNvCzHYjHYmA75XA","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.464 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.465 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.468 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6JXBKXFNvCzHYjHYmA75XA","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6I"}
[2025-11-19 13:24:29.470 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.471 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.475 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 6JXBKXFNvCzHYjHYmA75XA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6JXBKXFNvCzHYjHYmA75XA","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub"}
[2025-11-19 13:24:29.477 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.479 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.483 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.484 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.487 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.490 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.680 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:24:29.683 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:24:29.684 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
[2025-11-19 13:24:29.691 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
[2025-11-19 13:24:29.711 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:24:29.716 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
[2025-11-19 13:24:29.802 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:24:29.810 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
[2025-11-19 13:24:29.897 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:24:29.899 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:24:29.900 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:24:29.903 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:24:29.907 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5U:00000011","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S5U"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:24:29.911 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S5S:00000012","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S5S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:24:29.933 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:24:29.938 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:24:29.943 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S62:00000013","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S62"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:24:30.020 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:24:30.025 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:24:30.028 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S65:00000013","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S65"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:25:41.956 -05:00 INF] Verificando ruta: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6J:00000001","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S6J"}
[2025-11-19 13:25:41.962 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6J:00000001","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S6J"}
[2025-11-19 13:25:41.965 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6J:00000001","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S6J"}
[2025-11-19 13:25:41.967 -05:00 INF] Ruta privada detectada: /api/v1/contactos/search-users {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6J:00000001","RequestPath":"/api/v1/contactos/search-users","ConnectionId":"0HNH7IMNR0S6J"}
[2025-11-19 13:25:54.649 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"userCode":"1000000001","password":"***","rememberMe":true} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S6K:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6K"}
[2025-11-19 13:25:54.653 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6K:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6K"}
[2025-11-19 13:25:54.655 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6K:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6K"}
[2025-11-19 13:25:54.658 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6K:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6K"}
[2025-11-19 13:25:54.660 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6K:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6K"}
[2025-11-19 13:27:00.789 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"1000000001","cUsuarioContra":"admin123","bRecordarme":true} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.801 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.804 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.806 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.811 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.820 -05:00 INF] Buscando usuario por código: 1000000001 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:00.823 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.438 -05:00 INF] GetByEmailAsync: Buscando usuario por email: 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.655 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.665 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.884 -05:00 INF] GetByUsernameAsync: Usuario no encontrado por username: 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.910 -05:00 INF] Resultado búsqueda usuario: encontrado=false {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:01.916 -05:00 WRN] Login fallido: usuario no encontrado o inactivo. cUsuarioCodigo=1000000001 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"fae59192-51ef-4316-b24a-0b3414bb50ae","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6L:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7IMNR0S6L"}
[2025-11-19 13:27:14.290 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6M:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6M"}
[2025-11-19 13:27:14.298 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6M:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6M"}
[2025-11-19 13:27:14.299 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6M:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6M"}
[2025-11-19 13:27:14.301 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6M:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6M"}
[2025-11-19 13:29:05.006 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 6JXBKXFNvCzHYjHYmA75XA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"6JXBKXFNvCzHYjHYmA75XA","RequestId":"0HNH7IMNR0S6I:00000001","RequestPath":"/chathub"}
[2025-11-19 13:29:05.263 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.267 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.267 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.269 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.272 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.273 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.279 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.282 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.284 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.287 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.290 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.292 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.296 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.299 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.316 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E9LG2yCvVEeTqAShgYryQQ","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.316 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.317 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.320 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E9LG2yCvVEeTqAShgYryQQ","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.322 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.325 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.329 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E9LG2yCvVEeTqAShgYryQQ","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6P"}
[2025-11-19 13:29:05.333 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.336 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.339 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection E9LG2yCvVEeTqAShgYryQQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E9LG2yCvVEeTqAShgYryQQ","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub"}
[2025-11-19 13:29:05.341 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.347 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.358 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.364 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.369 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.371 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.378 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:05.381 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.837 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:29:05.849 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
[2025-11-19 13:29:05.900 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:29:05.909 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
[2025-11-19 13:29:06.005 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:29:06.014 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:29:06.018 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6O:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6O"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:29:06.121 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:29:06.127 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:29:06.130 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6N:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6N"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:31:45.421 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection E9LG2yCvVEeTqAShgYryQQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"E9LG2yCvVEeTqAShgYryQQ","RequestId":"0HNH7IMNR0S6P:00000001","RequestPath":"/chathub"}
[2025-11-19 13:31:45.424 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection oOOh8SU1uPpZtd84qf7RQw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"oOOh8SU1uPpZtd84qf7RQw","RequestId":"0HNH7IMNR0S6H:00000001","RequestPath":"/chathub"}
[2025-11-19 13:31:45.903 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.904 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:45.905 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.913 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:45.917 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:45.921 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:45.915 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.926 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.913 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:45.919 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:45.914 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:45.923 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:45.916 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:45.928 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.932 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:45.985 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:45.940 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:45.973 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mR4KgzHYq0opwm7jYdIkZw","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:45.978 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:45.980 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:45.937 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.002 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.005 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.013 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mR4KgzHYq0opwm7jYdIkZw","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:46.016 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:46.023 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.032 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.035 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.038 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mR4KgzHYq0opwm7jYdIkZw","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6U"}
[2025-11-19 13:31:46.040 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:46.046 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.057 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection mR4KgzHYq0opwm7jYdIkZw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mR4KgzHYq0opwm7jYdIkZw","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub"}
[2025-11-19 13:31:46.077 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"VJMTohYBPK7sRuIkO_o9Bw","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:46.103 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.084 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.114 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.104 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"VJMTohYBPK7sRuIkO_o9Bw","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:46.083 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.111 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.100 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.117 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.131 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"VJMTohYBPK7sRuIkO_o9Bw","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S6V"}
[2025-11-19 13:31:46.134 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.157 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.139 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.141 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.153 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection VJMTohYBPK7sRuIkO_o9Bw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"VJMTohYBPK7sRuIkO_o9Bw","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub"}
[2025-11-19 13:31:46.137 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.162 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.165 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.167 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.173 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.177 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.177 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.180 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.182 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.196 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.190 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.192 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.188 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.200 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.203 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.264 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.270 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.750 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:31:46.754 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
[2025-11-19 13:31:46.806 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:31:46.811 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:31:46.812 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
[2025-11-19 13:31:46.816 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
[2025-11-19 13:31:46.823 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:31:46.829 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
[2025-11-19 13:31:46.905 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:31:46.910 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:31:46.914 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6R:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6R"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:31:47.021 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:31:47.024 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:31:47.029 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:31:47.032 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:31:47.035 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6Q:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6Q"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:31:47.040 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6T:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S6T"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:31:47.072 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:31:47.078 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:31:47.082 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S6S:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S6S"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:39:47.716 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection mR4KgzHYq0opwm7jYdIkZw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"mR4KgzHYq0opwm7jYdIkZw","RequestId":"0HNH7IMNR0S6U:00000001","RequestPath":"/chathub"}
[2025-11-19 13:39:47.722 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection VJMTohYBPK7sRuIkO_o9Bw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"VJMTohYBPK7sRuIkO_o9Bw","RequestId":"0HNH7IMNR0S6V:00000001","RequestPath":"/chathub"}
[2025-11-19 13:39:48.138 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.141 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.145 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.149 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.154 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.152 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.156 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.160 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.165 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.167 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.169 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ALUtykilCMVrgMBqAdds6A","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.170 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.175 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.177 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ALUtykilCMVrgMBqAdds6A","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.179 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.197 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.181 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.184 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.185 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.188 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ALUtykilCMVrgMBqAdds6A","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S72"}
[2025-11-19 13:39:48.179 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.204 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.206 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.209 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.217 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection ALUtykilCMVrgMBqAdds6A {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ALUtykilCMVrgMBqAdds6A","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub"}
[2025-11-19 13:39:48.224 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.227 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.231 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.237 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.259 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.259 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.260 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.264 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.267 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.269 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.271 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"maoyF6-jF0NVAGXTDft7yQ","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.276 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S74:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S74"}
[2025-11-19 13:39:48.279 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.281 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.291 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"maoyF6-jF0NVAGXTDft7yQ","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.311 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"maoyF6-jF0NVAGXTDft7yQ","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S75"}
[2025-11-19 13:39:48.305 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.306 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.307 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.305 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.329 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.332 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.324 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.327 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.318 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection maoyF6-jF0NVAGXTDft7yQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"maoyF6-jF0NVAGXTDft7yQ","RequestId":"0HNH7IMNR0S75:00000001","RequestPath":"/chathub"}
[2025-11-19 13:39:48.322 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.341 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.344 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.346 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.353 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.355 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.358 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:48.361 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.363 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.366 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.374 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.387 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:48.389 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.398 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.862 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:39:48.866 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
[2025-11-19 13:39:48.871 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:39:48.876 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:39:48.969 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:39:48.976 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:39:49.001 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:39:49.005 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:39:49.009 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S73:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S73"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:39:49.076 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:39:49.084 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:39:49.090 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:39:49.207 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:39:49.225 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:39:49.230 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:39:49.331 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:39:49.337 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
[2025-11-19 13:39:49.584 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:39:49.591 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:39:49.595 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S76:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S76"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:40:03.594 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection ALUtykilCMVrgMBqAdds6A {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ALUtykilCMVrgMBqAdds6A","RequestId":"0HNH7IMNR0S72:00000001","RequestPath":"/chathub"}
[2025-11-19 13:40:03.843 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.845 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.846 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.849 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.850 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.851 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.853 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.855 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.857 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.860 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.863 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.865 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.867 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.869 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.889 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.891 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.897 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.898 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qSwdDbOW-dekDrSuphrIww","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.902 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.920 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.932 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.905 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.909 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qSwdDbOW-dekDrSuphrIww","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.935 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.938 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.941 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qSwdDbOW-dekDrSuphrIww","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S77"}
[2025-11-19 13:40:03.945 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.947 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.950 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection qSwdDbOW-dekDrSuphrIww {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qSwdDbOW-dekDrSuphrIww","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub"}
[2025-11-19 13:40:03.953 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:03.955 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:03.965 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:04.173 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:40:04.177 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:40:04.214 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:40:04.228 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:40:04.408 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:40:04.415 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:40:04.419 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:40:04.494 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:40:04.506 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:40:04.510 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:41:10.597 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection qSwdDbOW-dekDrSuphrIww {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"qSwdDbOW-dekDrSuphrIww","RequestId":"0HNH7IMNR0S77:00000001","RequestPath":"/chathub"}
[2025-11-19 13:41:10.839 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.843 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.843 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.846 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.846 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.848 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.851 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.852 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.854 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.856 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.858 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.860 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.863 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.866 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000A","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.880 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.882 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.882 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.882 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ODnsPL1nvJu4OKEWXTWj1Q","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.884 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.886 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.889 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ODnsPL1nvJu4OKEWXTWj1Q","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.891 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.893 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.895 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ODnsPL1nvJu4OKEWXTWj1Q","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S78"}
[2025-11-19 13:41:10.901 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.903 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.907 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection ODnsPL1nvJu4OKEWXTWj1Q {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ODnsPL1nvJu4OKEWXTWj1Q","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub"}
[2025-11-19 13:41:10.910 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.912 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.919 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:10.923 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:10.931 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:11.247 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:41:11.253 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:11.265 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:41:11.269 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:11.484 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:41:11.488 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:41:11.492 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000C","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:41:11.518 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:41:11.522 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:41:11.527 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000C","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:41:15.177 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection ODnsPL1nvJu4OKEWXTWj1Q {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ODnsPL1nvJu4OKEWXTWj1Q","RequestId":"0HNH7IMNR0S78:00000001","RequestPath":"/chathub"}
[2025-11-19 13:41:15.417 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.423 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.423 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000D","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.426 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.429 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.429 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000D","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.432 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.433 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.435 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000D","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.437 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.439 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.441 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000D","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.443 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000D","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.444 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.465 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.466 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.468 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.471 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.473 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.473 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"499C-xjFDGOgWin_PMNXyQ","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.474 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.477 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.480 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"499C-xjFDGOgWin_PMNXyQ","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.483 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.486 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.489 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"499C-xjFDGOgWin_PMNXyQ","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S79"}
[2025-11-19 13:41:15.491 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.494 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.496 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 499C-xjFDGOgWin_PMNXyQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"499C-xjFDGOgWin_PMNXyQ","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub"}
[2025-11-19 13:41:15.499 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.504 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.511 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.735 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:41:15.738 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
[2025-11-19 13:41:15.766 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:41:15.770 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
[2025-11-19 13:41:15.944 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:41:15.969 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:41:15.974 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S70:0000000E","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S70"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:41:16.022 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:41:16.027 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:41:16.031 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S71:0000000E","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S71"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:44:12.047 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 499C-xjFDGOgWin_PMNXyQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"499C-xjFDGOgWin_PMNXyQ","RequestId":"0HNH7IMNR0S79:00000001","RequestPath":"/chathub"}
[2025-11-19 13:44:12.304 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.323 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.331 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.338 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.341 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.343 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.346 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.353 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.360 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.358 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.355 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.387 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.387 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.401 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.403 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.405 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.408 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.411 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7A:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7A"}
[2025-11-19 13:44:12.416 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.417 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YjXzc7KZ6GiCpuKv80BdrQ","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.419 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.423 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.426 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YjXzc7KZ6GiCpuKv80BdrQ","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.428 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.430 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.433 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YjXzc7KZ6GiCpuKv80BdrQ","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7C"}
[2025-11-19 13:44:12.434 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.437 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.439 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection YjXzc7KZ6GiCpuKv80BdrQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YjXzc7KZ6GiCpuKv80BdrQ","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub"}
[2025-11-19 13:44:12.442 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:12.444 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:12.453 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:13.010 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:44:13.017 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:44:13.073 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:44:13.076 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:44:13.269 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:44:13.273 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:44:13.277 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:44:13.284 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:44:13.288 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:44:13.293 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:45:19.439 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection YjXzc7KZ6GiCpuKv80BdrQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YjXzc7KZ6GiCpuKv80BdrQ","RequestId":"0HNH7IMNR0S7C:00000001","RequestPath":"/chathub"}
[2025-11-19 13:45:19.719 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.721 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.722 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.723 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.725 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.727 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.727 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.729 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.730 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.733 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.735 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.738 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.740 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.744 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.770 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.772 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.775 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.775 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.776 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"t9H1TirG0a2fN8hRmQmtgw","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.777 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.779 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.784 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"t9H1TirG0a2fN8hRmQmtgw","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.787 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.789 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.799 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.795 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.793 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"t9H1TirG0a2fN8hRmQmtgw","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7E"}
[2025-11-19 13:45:19.802 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.806 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:19.808 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection t9H1TirG0a2fN8hRmQmtgw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"t9H1TirG0a2fN8hRmQmtgw","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub"}
[2025-11-19 13:45:19.811 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:19.820 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:20.041 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:45:20.045 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:20.053 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:45:20.056 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:20.257 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:45:20.281 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:45:20.282 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:45:20.289 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:45:20.292 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:45:20.299 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:45:49.015 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection t9H1TirG0a2fN8hRmQmtgw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"t9H1TirG0a2fN8hRmQmtgw","RequestId":"0HNH7IMNR0S7E:00000001","RequestPath":"/chathub"}
[2025-11-19 13:45:49.292 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.295 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.305 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.306 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.308 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.310 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.317 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.319 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.321 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.323 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.324 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.326 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000A","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.328 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.330 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"05be7e8f-954e-4f8d-841d-7438f94ca2d3","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:00000008","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.353 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0LIe4vNFqSK_OdSmjwJYkQ","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.354 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.355 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.357 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0LIe4vNFqSK_OdSmjwJYkQ","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.359 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.361 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.369 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0LIe4vNFqSK_OdSmjwJYkQ","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7IMNR0S7F"}
[2025-11-19 13:45:49.373 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.376 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.379 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 0LIe4vNFqSK_OdSmjwJYkQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"0LIe4vNFqSK_OdSmjwJYkQ","RequestId":"0HNH7IMNR0S7F:00000001","RequestPath":"/chathub"}
[2025-11-19 13:45:49.381 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.384 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.391 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.394 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.396 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.399 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.403 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.406 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.627 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:45:49.631 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
[2025-11-19 13:45:49.656 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:45:49.660 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
[2025-11-19 13:45:49.853 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:45:49.859 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:45:49.862 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:45:49.866 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:45:49.869 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"264c19ed-67fe-4621-a4cd-66553772c8c2","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7B:0000000B","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7IMNR0S7B"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:45:49.872 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"793b6cb9-8861-4ca1-88ce-4adefa7f1227","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7IMNR0S7D:0000000B","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7IMNR0S7D"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:51:34.188 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 13:51:34.224 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 13:54:24.368 -05:00 INF] Verificando ruta: /api/health {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BE:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BE"}
[2025-11-19 13:54:24.373 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BE:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BE"}
[2025-11-19 13:54:24.376 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BE:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BE"}
[2025-11-19 13:54:24.379 -05:00 INF] Ruta privada detectada: /api/health {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BE:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BE"}
[2025-11-19 13:55:00.417 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.417 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.417 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.420 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.422 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.424 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.427 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.429 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.431 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.434 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.437 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.439 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.501 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.535 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hEcyiOOD9uTNOiZHtOPJ3w","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.535 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BG:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BG"}
[2025-11-19 13:55:00.541 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hEcyiOOD9uTNOiZHtOPJ3w","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.548 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hEcyiOOD9uTNOiZHtOPJ3w","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BH"}
[2025-11-19 13:55:00.551 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection hEcyiOOD9uTNOiZHtOPJ3w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hEcyiOOD9uTNOiZHtOPJ3w","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub"}
[2025-11-19 13:55:00.585 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.585 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.594 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.592 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.597 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.600 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.602 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.605 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.609 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.611 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.626 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.626 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:00.632 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:00.634 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:01.522 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:55:01.532 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
[2025-11-19 13:55:01.642 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 13:55:01.649 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
[2025-11-19 13:55:01.758 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:55:01.763 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:55:01.777 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 13:55:01.905 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 13:55:01.912 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:55:01.916 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BI:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 13:56:21.478 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"testuser","cUsuarioContra":"test123","cTokenAcceso":"test-app-token","cTokenSecreto":"test-app-secret"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
[2025-11-19 13:56:21.490 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
[2025-11-19 13:56:21.492 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
[2025-11-19 13:56:21.494 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
[2025-11-19 13:56:21.497 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
[2025-11-19 13:56:21.877 -05:00 WRN] No se encontró AppRegistro por token de acceso {"SourceContext":"ChatModularMicroservice.Domain.TokenService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BJ:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BJ"}
System.Collections.Generic.KeyNotFoundException: No se encontró AppRegistro por token
   at ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepositoryAdapter.GetItem(AppRegistroFilter filter, AppRegistroFilterItemType filterType) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\AppRegistroRepositoryAdapter.cs:line 43
   at ChatModularMicroservice.Domain.TokenService.ValidarTokensAplicacionAsync(ValidarTokenRequest request) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\TokenService.cs:line 191
[2025-11-19 13:56:44.523 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"testuser","cUsuarioContra":"test123","cTokenAcceso":"SICOM_CHAT_2024_ACCESS","cTokenSecreto":"SICOM_CHAT_2024_SECRET"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
[2025-11-19 13:56:44.529 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
[2025-11-19 13:56:44.531 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
[2025-11-19 13:56:44.533 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
[2025-11-19 13:56:44.535 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
[2025-11-19 13:56:44.934 -05:00 WRN] No se encontró AppRegistro por token de acceso {"SourceContext":"ChatModularMicroservice.Domain.TokenService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BK:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BK"}
System.Collections.Generic.KeyNotFoundException: No se encontró AppRegistro por token
   at ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepositoryAdapter.GetItem(AppRegistroFilter filter, AppRegistroFilterItemType filterType) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\AppRegistroRepositoryAdapter.cs:line 43
   at ChatModularMicroservice.Domain.TokenService.ValidarTokensAplicacionAsync(ValidarTokenRequest request) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\TokenService.cs:line 191
[2025-11-19 13:57:01.760 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"testuser","cUsuarioContra":"test123","cTokenAcceso":"CHAT_API_2024_ACCESS","cTokenSecreto":"CHAT_API_2024_SECRET"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
[2025-11-19 13:57:01.763 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
[2025-11-19 13:57:01.766 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
[2025-11-19 13:57:01.768 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
[2025-11-19 13:57:01.770 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
[2025-11-19 13:57:02.001 -05:00 WRN] No se encontró AppRegistro por token de acceso {"SourceContext":"ChatModularMicroservice.Domain.TokenService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BL:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69BL"}
System.Collections.Generic.KeyNotFoundException: No se encontró AppRegistro por token
   at ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepositoryAdapter.GetItem(AppRegistroFilter filter, AppRegistroFilterItemType filterType) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\Repositories\AppRegistroRepositoryAdapter.cs:line 43
   at ChatModularMicroservice.Domain.TokenService.ValidarTokensAplicacionAsync(ValidarTokenRequest request) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\TokenService.cs:line 191
[2025-11-19 13:57:33.524 -05:00 INF] Verificando ruta: /api/health {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BM:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BM"}
[2025-11-19 13:57:33.527 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BM:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BM"}
[2025-11-19 13:57:33.529 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BM:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BM"}
[2025-11-19 13:57:33.532 -05:00 INF] Ruta privada detectada: /api/health {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BM:00000001","RequestPath":"/api/health","ConnectionId":"0HNH7JK7B69BM"}
[2025-11-19 13:58:19.436 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BN:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BN"}
[2025-11-19 13:58:19.440 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BN:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BN"}
[2025-11-19 13:58:19.441 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BN:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BN"}
[2025-11-19 13:58:19.443 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BN:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BN"}
[2025-11-19 13:58:42.174 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/generar-tokens-aplicacion, Body: {"nombreApp":"TestApp","codigoApp":"TEST_APP_001"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69BO:00000001","RequestPath":"/api/v1/auth/generar-tokens-aplicacion","ConnectionId":"0HNH7JK7B69BO"}
[2025-11-19 13:58:42.177 -05:00 INF] Verificando ruta: /api/v1/auth/generar-tokens-aplicacion {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BO:00000001","RequestPath":"/api/v1/auth/generar-tokens-aplicacion","ConnectionId":"0HNH7JK7B69BO"}
[2025-11-19 13:58:42.180 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BO:00000001","RequestPath":"/api/v1/auth/generar-tokens-aplicacion","ConnectionId":"0HNH7JK7B69BO"}
[2025-11-19 13:58:42.182 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BO:00000001","RequestPath":"/api/v1/auth/generar-tokens-aplicacion","ConnectionId":"0HNH7JK7B69BO"}
[2025-11-19 13:58:42.183 -05:00 INF] Ruta pública detectada: /api/v1/auth/generar-tokens-aplicacion {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BO:00000001","RequestPath":"/api/v1/auth/generar-tokens-aplicacion","ConnectionId":"0HNH7JK7B69BO"}
[2025-11-19 14:07:22.343 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection hEcyiOOD9uTNOiZHtOPJ3w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hEcyiOOD9uTNOiZHtOPJ3w","RequestId":"0HNH7JK7B69BH:00000001","RequestPath":"/chathub"}
[2025-11-19 14:07:22.608 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.611 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.614 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.616 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.617 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.619 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.622 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.630 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.632 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.635 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.639 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.640 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.644 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.652 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.680 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVzjwxxHlrwC_h4SnuNsew","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.681 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.681 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.683 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVzjwxxHlrwC_h4SnuNsew","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.685 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.687 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.691 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVzjwxxHlrwC_h4SnuNsew","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BR"}
[2025-11-19 14:07:22.695 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.698 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.702 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection NVzjwxxHlrwC_h4SnuNsew {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVzjwxxHlrwC_h4SnuNsew","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub"}
[2025-11-19 14:07:22.705 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.707 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.715 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.717 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.721 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.722 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:22.724 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:22.729 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:23.327 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:07:23.338 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
[2025-11-19 14:07:23.340 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:07:23.348 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
[2025-11-19 14:07:23.571 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:07:23.587 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:07:23.592 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BQ:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BQ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:07:23.595 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:07:23.604 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:07:23.608 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BP:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BP"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:11:03.012 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection NVzjwxxHlrwC_h4SnuNsew {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"NVzjwxxHlrwC_h4SnuNsew","RequestId":"0HNH7JK7B69BR:00000001","RequestPath":"/chathub"}
[2025-11-19 14:11:03.293 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.296 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.297 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.298 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.300 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.301 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.302 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.303 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.305 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.307 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.310 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.312 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.314 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.320 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.342 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.345 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CbWIUs2j67Z3G4mnM2C9bQ","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.346 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.347 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.349 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CbWIUs2j67Z3G4mnM2C9bQ","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.351 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.353 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.356 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CbWIUs2j67Z3G4mnM2C9bQ","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69BV"}
[2025-11-19 14:11:03.358 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.362 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.365 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection CbWIUs2j67Z3G4mnM2C9bQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CbWIUs2j67Z3G4mnM2C9bQ","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub"}
[2025-11-19 14:11:03.368 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.372 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.378 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.380 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.384 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:03.387 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.392 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.907 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:11:03.926 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
[2025-11-19 14:11:03.940 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:11:03.945 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
[2025-11-19 14:11:04.138 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:11:04.142 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:11:04.150 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BU:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69BU"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:11:04.170 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:11:04.176 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:11:04.182 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69BT:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69BT"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:13:57.984 -05:00 INF] Verificando ruta: /api/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C0:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C0"}
[2025-11-19 14:13:57.988 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C0:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C0"}
[2025-11-19 14:13:57.990 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C0:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C0"}
[2025-11-19 14:13:57.992 -05:00 INF] Ruta privada detectada: /api/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C0:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C0"}
[2025-11-19 14:14:08.110 -05:00 INF] Verificando ruta: /api/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C1:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C1"}
[2025-11-19 14:14:08.114 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C1:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C1"}
[2025-11-19 14:14:08.116 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C1:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C1"}
[2025-11-19 14:14:08.118 -05:00 INF] Ruta privada detectada: /api/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C1:00000001","RequestPath":"/api/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C1"}
[2025-11-19 14:17:47.045 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection CbWIUs2j67Z3G4mnM2C9bQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"CbWIUs2j67Z3G4mnM2C9bQ","RequestId":"0HNH7JK7B69BV:00000001","RequestPath":"/chathub"}
[2025-11-19 14:17:47.284 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.286 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.287 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.289 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.290 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.291 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.293 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.296 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.299 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.301 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.303 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.305 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.308 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.312 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.328 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.330 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.331 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.333 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.335 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C04AulR_tWjb70exaSB2gQ","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.336 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.338 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.341 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C04AulR_tWjb70exaSB2gQ","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.343 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.346 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.350 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C04AulR_tWjb70exaSB2gQ","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C4"}
[2025-11-19 14:17:47.354 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.357 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.360 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection C04AulR_tWjb70exaSB2gQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C04AulR_tWjb70exaSB2gQ","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub"}
[2025-11-19 14:17:47.365 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.367 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.377 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:47.380 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.843 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:17:47.864 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:47.908 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:17:47.917 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:48.028 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:17:48.034 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:17:48.037 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:17:48.129 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:17:48.135 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:17:48.140 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C2"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:17:52.446 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection C04AulR_tWjb70exaSB2gQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C04AulR_tWjb70exaSB2gQ","RequestId":"0HNH7JK7B69C4:00000001","RequestPath":"/chathub"}
[2025-11-19 14:17:52.684 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.685 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.686 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.688 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.688 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.690 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.693 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.695 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.697 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.699 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.701 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.703 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.707 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.723 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C2:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69C2"}
[2025-11-19 14:17:52.733 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.735 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.736 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C0v302Ebz-i2W0Twd5Ru4w","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.738 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.740 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.746 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C0v302Ebz-i2W0Twd5Ru4w","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.755 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.759 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.765 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C0v302Ebz-i2W0Twd5Ru4w","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69C5"}
[2025-11-19 14:17:52.768 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.771 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.775 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection C0v302Ebz-i2W0Twd5Ru4w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C0v302Ebz-i2W0Twd5Ru4w","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub"}
[2025-11-19 14:17:52.778 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.782 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.787 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.790 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.793 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:52.797 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:52.948 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:17:52.951 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
[2025-11-19 14:17:53.012 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:17:53.017 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
[2025-11-19 14:17:53.096 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:17:53.101 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:17:53.106 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C3:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C3"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:17:53.241 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:17:53.248 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:17:53.254 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69C6:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C6"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:30:38.792 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C7"}
[2025-11-19 14:30:38.797 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C7"}
[2025-11-19 14:30:38.798 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C7"}
[2025-11-19 14:30:38.800 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69C7"}
[2025-11-19 14:30:49.801 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C8:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C8"}
[2025-11-19 14:30:49.804 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C8:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C8"}
[2025-11-19 14:30:49.806 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C8:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C8"}
[2025-11-19 14:30:49.808 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C8:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69C8"}
[2025-11-19 14:31:26.005 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {
    "email": "test@example.com",
    "password": "***"
  } {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69C9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69C9"}
[2025-11-19 14:31:26.008 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69C9"}
[2025-11-19 14:31:26.010 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69C9"}
[2025-11-19 14:31:26.012 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69C9"}
[2025-11-19 14:31:26.014 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69C9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69C9"}
[2025-11-19 14:31:37.238 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {
    "cUsuarioCodigo": "test@example.com",
    "cUsuarioContra": "test123"
  } {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.247 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.252 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.254 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.257 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.259 -05:00 INF] Buscando usuario por código: test@example.com {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:37.262 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: test@example.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.182 -05:00 INF] GetByEmailAsync: Buscando usuario por email: test@example.com {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.534 -05:00 INF] GetByEmailAsync: Usuario encontrado, rol asignado: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.545 -05:00 INF] GetByUserCodeAsync: Encontrado por Email, rol: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.548 -05:00 INF] Resultado búsqueda usuario: encontrado=true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.786 -05:00 INF] Validación de contraseña con BCrypt para usuario test@example.com: false {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:31:38.797 -05:00 WRN] Login fallido: contraseña inválida para usuario test@example.com {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"bfdb1a83-a176-4f35-b8ac-1f18ff6e84b7","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CA:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7JK7B69CA"}
[2025-11-19 14:33:22.299 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.301 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.302 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.303 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.304 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.306 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.308 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.310 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.311 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.313 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.315 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.317 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.319 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.320 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.387 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"vPrlPrsPgcgDhEEhs7UCeA","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.390 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"vPrlPrsPgcgDhEEhs7UCeA","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.391 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.393 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"vPrlPrsPgcgDhEEhs7UCeA","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CD"}
[2025-11-19 14:33:22.395 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.397 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection vPrlPrsPgcgDhEEhs7UCeA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"vPrlPrsPgcgDhEEhs7UCeA","RequestId":"0HNH7JK7B69CD:00000001","RequestPath":"/chathub"}
[2025-11-19 14:33:22.399 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.399 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.403 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.406 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.408 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.410 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.413 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.415 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.420 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:22.424 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.430 -05:00 INF] Listando contactos para usuario 1000000001 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.433 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:22.960 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:33:22.965 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
[2025-11-19 14:33:23.223 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:33:23.228 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:33:23.231 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CC:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CC"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:33:23.376 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:33:23.387 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
[2025-11-19 14:33:23.673 -05:00 ERR] Error al listar contactos para usuario 1000000001: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:33:23.677 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:33:23.681 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CB"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:33:29.911 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection C0v302Ebz-i2W0Twd5Ru4w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"C0v302Ebz-i2W0Twd5Ru4w","RequestId":"0HNH7JK7B69C5:00000001","RequestPath":"/chathub"}
[2025-11-19 14:33:30.169 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.172 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.173 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.175 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.177 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.178 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.180 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.181 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.184 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.186 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.188 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.190 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.193 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.194 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.216 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.218 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.218 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.218 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"f5s5nK4N84MgBIwiTuh60w","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.220 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.222 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.224 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"f5s5nK4N84MgBIwiTuh60w","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.226 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.228 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.231 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"f5s5nK4N84MgBIwiTuh60w","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CG"}
[2025-11-19 14:33:30.233 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.235 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.238 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection f5s5nK4N84MgBIwiTuh60w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"f5s5nK4N84MgBIwiTuh60w","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub"}
[2025-11-19 14:33:30.242 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.244 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.250 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.253 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.259 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.482 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:33:30.489 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
[2025-11-19 14:33:30.517 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:33:30.522 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
[2025-11-19 14:33:30.705 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:33:30.717 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:33:30.724 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CF:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CF"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:33:30.766 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:33:30.771 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:33:30.775 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CE:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CE"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:36:07.696 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CH"}
[2025-11-19 14:36:07.699 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CH"}
[2025-11-19 14:36:07.701 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CH"}
[2025-11-19 14:36:07.702 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CH:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CH"}
[2025-11-19 14:46:20.498 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection f5s5nK4N84MgBIwiTuh60w {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"f5s5nK4N84MgBIwiTuh60w","RequestId":"0HNH7JK7B69CG:00000001","RequestPath":"/chathub"}
[2025-11-19 14:46:20.758 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.762 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.762 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.765 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.766 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.767 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.770 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.772 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.775 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.780 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.782 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.785 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.788 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.789 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.806 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.807 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"1gDwuPN4mHI6eM11jQi-nQ","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.807 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.808 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.812 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"1gDwuPN4mHI6eM11jQi-nQ","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.815 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.818 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.821 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"1gDwuPN4mHI6eM11jQi-nQ","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CK"}
[2025-11-19 14:46:20.824 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.827 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.831 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection 1gDwuPN4mHI6eM11jQi-nQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"1gDwuPN4mHI6eM11jQi-nQ","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub"}
[2025-11-19 14:46:20.834 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.836 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.841 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.846 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.848 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:20.852 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:20.855 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:21.466 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:46:21.469 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:46:21.471 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:21.476 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:21.706 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:46:21.709 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:46:21.723 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:46:21.728 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:46:21.733 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000004","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:46:21.736 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:46:29.271 -05:00 INF] User José Santillan disconnected from app SICOM_CHAT_2024 with connection 1gDwuPN4mHI6eM11jQi-nQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"1gDwuPN4mHI6eM11jQi-nQ","RequestId":"0HNH7JK7B69CK:00000001","RequestPath":"/chathub"}
[2025-11-19 14:46:29.517 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.519 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.520 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.521 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.523 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.524 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.525 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.528 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.530 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.533 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.535 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.536 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.539 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"11d70fe1-e832-49af-91d4-676436c1c076","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000006","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.542 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.558 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.561 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.565 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.565 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"jJEwA3OozH-JrwVtqwjhrg","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.575 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.581 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.584 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000003, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:josantillan@gmail.com, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:José Santillan, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:José Santillan, per_codigo:ce25a748-1783-4edb-bf26-f366a73098a1, per_jur_codigo:DEFAULT, user_id:1000000003, app_code:SICOM_CHAT_2024, nbf:1763574133, exp:1763833333, iat:1763574133, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"jJEwA3OozH-JrwVtqwjhrg","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.588 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.591 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.597 -05:00 INF] Extracted user info - UserId: 1000000003, UserName: José Santillan {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"jJEwA3OozH-JrwVtqwjhrg","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7JK7B69CL"}
[2025-11-19 14:46:29.600 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.603 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.606 -05:00 INF] User José Santillan connected to app SICOM_CHAT_2024 with connection jJEwA3OozH-JrwVtqwjhrg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"jJEwA3OozH-JrwVtqwjhrg","RequestId":"0HNH7JK7B69CL:00000001","RequestPath":"/chathub"}
[2025-11-19 14:46:29.608 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.611 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.616 -05:00 INF] Listando contactos para usuario 1000000003 en empresa 1 y aplicación 1 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.620 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.623 -05:00 INF] Ejecutando stored procedure (lista): usp_contactos_listarcontactos {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:29.835 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:46:29.846 -05:00 ERR] Error ejecutando stored procedure usp_contactos_listarcontactos: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.contactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.Repositories.SupabaseRepository.ExecuteStoredProcedureListAsync[T](String procedureName, Object parameters, String clientName) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\SupabaseRepository.cs:line 101
[2025-11-19 14:46:29.873 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
[2025-11-19 14:46:29.906 -05:00 INF] Fallback a tabla chatcontactos para usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
[2025-11-19 14:46:30.159 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:46:30.182 -05:00 ERR] Error al listar contactos para usuario 1000000003: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
[2025-11-19 14:46:30.193 -05:00 ERR] Error al obtener contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:46:30.199 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000003 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
[2025-11-19 14:46:30.203 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"3c7f4d51-7e04-4654-ae5e-f37f77cf18f0","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CI:00000008","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7JK7B69CI"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
[2025-11-19 14:46:30.207 -05:00 ERR] Error en controlador: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"} {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"fe4f835a-7ee3-40d3-84c2-4461666dbe1a","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7JK7B69CJ:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7JK7B69CJ"}
Supabase.Postgrest.Exceptions.PostgrestException: {"code":"42P01","details":null,"hint":null,"message":"relation \"public.chatcontactos\" does not exist"}
   at Supabase.Postgrest.Helpers.MakeRequest(ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, CancellationToken cancellationToken)
   at Supabase.Postgrest.Helpers.MakeRequest[T](ClientOptions clientOptions, HttpMethod method, String url, JsonSerializerSettings serializerSettings, Object data, Dictionary`2 headers, Func`1 getHeaders, CancellationToken cancellationToken)
   at ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoSupabaseRepository.cs:line 72
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in D:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
