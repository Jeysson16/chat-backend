[2025-11-19 15:06:18.533 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:06:18.574 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:06:45.715 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7KSL5J4FS:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FS"}
[2025-11-19 15:06:45.726 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FS:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FS"}
[2025-11-19 15:06:45.729 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FS:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FS"}
[2025-11-19 15:06:45.732 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FS:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FS"}
[2025-11-19 15:06:45.734 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FS:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FS"}
[2025-11-19 15:06:55.767 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FT:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FT"}
[2025-11-19 15:06:55.776 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FT:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FT"}
[2025-11-19 15:06:55.779 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FT:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FT"}
[2025-11-19 15:06:55.782 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FT:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FT"}
[2025-11-19 15:07:07.997 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G0"}
[2025-11-19 15:07:07.997 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:07.997 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.000 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G0"}
[2025-11-19 15:07:08.004 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.006 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.008 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G0"}
[2025-11-19 15:07:08.010 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.013 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.014 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G0"}
[2025-11-19 15:07:08.016 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.018 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.078 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.100 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"f3fc0495-c818-48bc-b979-713a3d743634","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7KSL5J4FU:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:08.101 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:07:08.104 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"bliGAuyU2OcDX6WXJMTHfQ","RequestId":"0HNH7KSL5J4G0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G0"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:08.156 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.158 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.160 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.162 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.165 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4FV"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:07:08.191 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.194 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.194 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.197 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.199 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.201 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.203 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.205 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.207 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.209 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.217 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:08.218 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:08.234 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.236 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.239 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.242 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.242 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.244 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
[2025-11-19 15:07:08.245 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.247 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FV:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FV"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:08.248 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.256 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.259 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:08.262 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:10.158 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G2"}
[2025-11-19 15:07:10.160 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G2"}
[2025-11-19 15:07:10.162 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G2"}
[2025-11-19 15:07:10.163 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G2"}
[2025-11-19 15:07:10.172 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"B_A5uGZ40-5yIDeT1t-t3Q","RequestId":"0HNH7KSL5J4G2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G2"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:12.191 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G3:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G3"}
[2025-11-19 15:07:12.194 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G3:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G3"}
[2025-11-19 15:07:12.196 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G3:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G3"}
[2025-11-19 15:07:12.198 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G3:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G3"}
[2025-11-19 15:07:12.204 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"CDVHZWzsWUT0hxZLe1W_qw","RequestId":"0HNH7KSL5J4G3:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G3"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:14.225 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G4"}
[2025-11-19 15:07:14.230 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G4"}
[2025-11-19 15:07:14.232 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G4"}
[2025-11-19 15:07:14.234 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G4"}
[2025-11-19 15:07:14.239 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"OmBGb0Obw7Ny-75bXu8mDA","RequestId":"0HNH7KSL5J4G4:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G4"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:16.262 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G5"}
[2025-11-19 15:07:16.267 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G5"}
[2025-11-19 15:07:16.272 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G5"}
[2025-11-19 15:07:16.276 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G5"}
[2025-11-19 15:07:16.281 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"s9zG-uaDeXVi2mmZN7HMKA","RequestId":"0HNH7KSL5J4G5:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G5"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:18.305 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G6"}
[2025-11-19 15:07:18.307 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G6"}
[2025-11-19 15:07:18.309 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G6"}
[2025-11-19 15:07:18.311 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G6"}
[2025-11-19 15:07:18.316 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"S1EjSV72pMwCMG0aaO5NPg","RequestId":"0HNH7KSL5J4G6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G6"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:20.343 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G7"}
[2025-11-19 15:07:20.346 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G7"}
[2025-11-19 15:07:20.348 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G7"}
[2025-11-19 15:07:20.350 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G7"}
[2025-11-19 15:07:20.357 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"_rtXgLwTfhJJWyA63hLCKg","RequestId":"0HNH7KSL5J4G7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:22.382 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G8:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G8"}
[2025-11-19 15:07:22.385 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G8:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G8"}
[2025-11-19 15:07:22.387 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G8:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G8"}
[2025-11-19 15:07:22.390 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G8:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G8"}
[2025-11-19 15:07:22.394 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"U-rT9lsH2GbbE9bLUm6ZaQ","RequestId":"0HNH7KSL5J4G8:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:24.414 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G9"}
[2025-11-19 15:07:24.416 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G9"}
[2025-11-19 15:07:24.419 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G9"}
[2025-11-19 15:07:24.421 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G9"}
[2025-11-19 15:07:24.427 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"E4PWWiGzItvmpc3JYdQUsg","RequestId":"0HNH7KSL5J4G9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4G9"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:26.452 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GA"}
[2025-11-19 15:07:26.455 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GA"}
[2025-11-19 15:07:26.457 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GA"}
[2025-11-19 15:07:26.459 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GA"}
[2025-11-19 15:07:26.464 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"BkhYBKK0BYHheHsFU-5l-Q","RequestId":"0HNH7KSL5J4GA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GA"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:28.494 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GB"}
[2025-11-19 15:07:28.507 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GB"}
[2025-11-19 15:07:28.511 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GB"}
[2025-11-19 15:07:28.514 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GB"}
[2025-11-19 15:07:28.519 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"i3y3Zf_UyXHmMGi63k-eGg","RequestId":"0HNH7KSL5J4GB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GB"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:30.539 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GC"}
[2025-11-19 15:07:30.545 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GC"}
[2025-11-19 15:07:30.547 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GC"}
[2025-11-19 15:07:30.548 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GC"}
[2025-11-19 15:07:30.554 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"7z_DyDZocaS7IIlx6ntFPQ","RequestId":"0HNH7KSL5J4GC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:32.574 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GD"}
[2025-11-19 15:07:32.580 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GD"}
[2025-11-19 15:07:32.581 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GD"}
[2025-11-19 15:07:32.583 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GD"}
[2025-11-19 15:07:32.589 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"5durWLAzJhtoe-L2Hgt43g","RequestId":"0HNH7KSL5J4GD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GD"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:34.621 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GE"}
[2025-11-19 15:07:34.635 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GE"}
[2025-11-19 15:07:34.639 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GE"}
[2025-11-19 15:07:34.642 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GE"}
[2025-11-19 15:07:34.649 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"_YCmXbzQTzzYEBGDpXJZcw","RequestId":"0HNH7KSL5J4GE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GE"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:36.673 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GF"}
[2025-11-19 15:07:36.676 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GF"}
[2025-11-19 15:07:36.678 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GF"}
[2025-11-19 15:07:36.681 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GF"}
[2025-11-19 15:07:36.686 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"iOzO0kiKRysJ2Pf5VZMHhg","RequestId":"0HNH7KSL5J4GF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GF"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:38.708 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GG"}
[2025-11-19 15:07:38.710 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GG"}
[2025-11-19 15:07:38.712 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GG"}
[2025-11-19 15:07:38.714 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GG"}
[2025-11-19 15:07:38.719 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"7vBK8FLJ06j6XofjmL7CQQ","RequestId":"0HNH7KSL5J4GG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GG"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:40.742 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GH"}
[2025-11-19 15:07:40.745 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GH"}
[2025-11-19 15:07:40.748 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GH"}
[2025-11-19 15:07:40.750 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GH"}
[2025-11-19 15:07:40.757 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"pzDOeJ6YdncUERovElCzHA","RequestId":"0HNH7KSL5J4GH:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GH"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:42.792 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GI"}
[2025-11-19 15:07:42.800 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GI"}
[2025-11-19 15:07:42.802 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GI"}
[2025-11-19 15:07:42.805 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GI"}
[2025-11-19 15:07:42.810 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"GFlYvVgC_0PI2AOtQNRuwA","RequestId":"0HNH7KSL5J4GI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GI"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:44.844 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GJ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GJ"}
[2025-11-19 15:07:44.850 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GJ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GJ"}
[2025-11-19 15:07:44.853 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GJ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GJ"}
[2025-11-19 15:07:44.855 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GJ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GJ"}
[2025-11-19 15:07:44.859 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"CaWDq6hTI4SF_Dto5g8FtA","RequestId":"0HNH7KSL5J4GJ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GJ"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:46.888 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GK"}
[2025-11-19 15:07:46.892 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GK"}
[2025-11-19 15:07:46.895 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GK"}
[2025-11-19 15:07:46.896 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GK"}
[2025-11-19 15:07:46.901 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"8OCyrY79inn4NJuKBweP8Q","RequestId":"0HNH7KSL5J4GK:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GK"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:47.445 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.448 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.448 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.451 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.452 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GL"}
[2025-11-19 15:07:47.453 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.456 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.458 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GL"}
[2025-11-19 15:07:47.460 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.462 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.463 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GL"}
[2025-11-19 15:07:47.465 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.468 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"f3fc0495-c818-48bc-b979-713a3d743634","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7KSL5J4FU:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.469 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GL"}
[2025-11-19 15:07:47.473 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:07:47.481 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"jLgX4Oeq0TbDatp4LN2PWQ","RequestId":"0HNH7KSL5J4GL:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GL"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:47.501 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.504 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.507 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.510 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.513 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000006","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:07:47.534 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.535 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.538 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.541 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.543 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.545 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.547 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.550 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.552 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.554 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.558 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4FU"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:47.561 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:00000009","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:47.579 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.581 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.584 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.586 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.589 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
[2025-11-19 15:07:47.593 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4G1:0000000A","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KSL5J4G1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:47.594 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.601 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.604 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.607 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.610 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
[2025-11-19 15:07:47.613 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4FU:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KSL5J4FU"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:07:49.520 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GM"}
[2025-11-19 15:07:49.524 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GM"}
[2025-11-19 15:07:49.526 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GM"}
[2025-11-19 15:07:49.528 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GM"}
[2025-11-19 15:07:49.534 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"kzY1BYMKprUUF3j0rpU4Xw","RequestId":"0HNH7KSL5J4GM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GM"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:51.558 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GN"}
[2025-11-19 15:07:51.562 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GN"}
[2025-11-19 15:07:51.564 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GN"}
[2025-11-19 15:07:51.566 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GN"}
[2025-11-19 15:07:51.572 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"njHR-nQcyjeaiIgmLTTiAg","RequestId":"0HNH7KSL5J4GN:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GN"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:53.594 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GO:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GO"}
[2025-11-19 15:07:53.597 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GO:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GO"}
[2025-11-19 15:07:53.599 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GO:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GO"}
[2025-11-19 15:07:53.602 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GO:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GO"}
[2025-11-19 15:07:53.608 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"mtcH6eKvThtoNbQbldw4sw","RequestId":"0HNH7KSL5J4GO:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GO"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:55.627 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GP:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GP"}
[2025-11-19 15:07:55.630 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GP:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GP"}
[2025-11-19 15:07:55.634 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GP:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GP"}
[2025-11-19 15:07:55.635 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GP:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GP"}
[2025-11-19 15:07:55.640 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"3Ms6PkABXyehISN9kO7o7A","RequestId":"0HNH7KSL5J4GP:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GP"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:57.658 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GQ"}
[2025-11-19 15:07:57.661 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GQ"}
[2025-11-19 15:07:57.662 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GQ"}
[2025-11-19 15:07:57.664 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GQ"}
[2025-11-19 15:07:57.668 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"OOeDfDohN36wzdDy3EEz2w","RequestId":"0HNH7KSL5J4GQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GQ"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:07:59.695 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GR"}
[2025-11-19 15:07:59.705 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GR"}
[2025-11-19 15:07:59.710 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GR"}
[2025-11-19 15:07:59.713 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GR"}
[2025-11-19 15:07:59.717 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"UdGU9wGSmvOlOK32q-RJyA","RequestId":"0HNH7KSL5J4GR:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GR"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:01.749 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GS:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GS"}
[2025-11-19 15:08:01.753 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GS:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GS"}
[2025-11-19 15:08:01.756 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GS:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GS"}
[2025-11-19 15:08:01.759 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GS:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GS"}
[2025-11-19 15:08:01.763 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"oryfcyndGc97I60TwYlMWQ","RequestId":"0HNH7KSL5J4GS:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GS"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:03.807 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GT"}
[2025-11-19 15:08:03.816 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GT"}
[2025-11-19 15:08:03.819 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GT"}
[2025-11-19 15:08:03.821 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GT"}
[2025-11-19 15:08:03.826 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"dwq3M2PKSwa6v4_LpgsHSA","RequestId":"0HNH7KSL5J4GT:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GT"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:05.857 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GU"}
[2025-11-19 15:08:05.859 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GU"}
[2025-11-19 15:08:05.862 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GU"}
[2025-11-19 15:08:05.865 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GU"}
[2025-11-19 15:08:05.869 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"9cJyxXxrKVPkbt6Ao5PZVA","RequestId":"0HNH7KSL5J4GU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GU"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:07.895 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GV"}
[2025-11-19 15:08:07.898 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GV"}
[2025-11-19 15:08:07.900 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GV"}
[2025-11-19 15:08:07.903 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4GV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GV"}
[2025-11-19 15:08:07.909 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"tTj8YcbV0TyQwE1euPxUng","RequestId":"0HNH7KSL5J4GV:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4GV"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:09.944 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H0"}
[2025-11-19 15:08:09.951 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H0"}
[2025-11-19 15:08:09.954 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H0"}
[2025-11-19 15:08:09.956 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H0"}
[2025-11-19 15:08:09.961 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"Q8GTQFO3v_b3-5dz8zsyng","RequestId":"0HNH7KSL5J4H0:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H0"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:12.002 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H1"}
[2025-11-19 15:08:12.011 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H1"}
[2025-11-19 15:08:12.015 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H1"}
[2025-11-19 15:08:12.018 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KSL5J4H1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H1"}
[2025-11-19 15:08:12.023 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"9AXWAxIFdkTr9TWDd3Siqw","RequestId":"0HNH7KSL5J4H1:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KSL5J4H1"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:20.125 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:08:20.165 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:08:21.451 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
[2025-11-19 15:08:21.464 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.464 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.464 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
[2025-11-19 15:08:21.467 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.469 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.473 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
[2025-11-19 15:08:21.476 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.478 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.482 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
[2025-11-19 15:08:21.485 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.488 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.491 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
[2025-11-19 15:08:21.547 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.563 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:08:21.570 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"1c716378-d062-40a5-bdad-f0ed16e3ef7e","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7KTHMHIV6:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTHMHIV6"}
[2025-11-19 15:08:21.572 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"gW-Oe6sYhF0G6JE1CwiGaw","RequestId":"0HNH7KTHMHIV7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:21.619 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.623 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.628 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.630 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.635 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTHMHIV5"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:08:21.665 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.667 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.668 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.670 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.675 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.678 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.681 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.683 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.686 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.690 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.700 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:21.701 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:21.715 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.717 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.720 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.723 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.724 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.726 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
[2025-11-19 15:08:21.728 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.732 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV5:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTHMHIV5"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method64(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:21.733 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.745 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.747 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
[2025-11-19 15:08:21.751 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV8:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTHMHIV8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:23.609 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV9"}
[2025-11-19 15:08:23.614 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV9"}
[2025-11-19 15:08:23.616 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV9"}
[2025-11-19 15:08:23.618 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIV9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV9"}
[2025-11-19 15:08:23.627 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"v5VJf6wBVnzsHZRUf47wpA","RequestId":"0HNH7KTHMHIV9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIV9"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:25.660 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVA"}
[2025-11-19 15:08:25.663 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVA"}
[2025-11-19 15:08:25.666 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVA"}
[2025-11-19 15:08:25.667 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVA"}
[2025-11-19 15:08:25.673 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"BEeJbt_io1xOoz4nCs6Llg","RequestId":"0HNH7KTHMHIVA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVA"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:27.694 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVB"}
[2025-11-19 15:08:27.698 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVB"}
[2025-11-19 15:08:27.700 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVB"}
[2025-11-19 15:08:27.702 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVB"}
[2025-11-19 15:08:27.708 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"Wyg5hkx0r5H38LmcSswNhw","RequestId":"0HNH7KTHMHIVB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVB"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:29.742 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVC"}
[2025-11-19 15:08:29.746 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVC"}
[2025-11-19 15:08:29.749 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVC"}
[2025-11-19 15:08:29.750 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVC"}
[2025-11-19 15:08:29.756 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"HFoZsWaKhJXNiZiBXAvoZw","RequestId":"0HNH7KTHMHIVC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:31.777 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVD"}
[2025-11-19 15:08:31.783 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVD"}
[2025-11-19 15:08:31.785 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVD"}
[2025-11-19 15:08:31.786 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVD"}
[2025-11-19 15:08:31.793 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"Dbl15Bf13q15sACf9_JnTQ","RequestId":"0HNH7KTHMHIVD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVD"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:33.830 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVE"}
[2025-11-19 15:08:33.834 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVE"}
[2025-11-19 15:08:33.836 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVE"}
[2025-11-19 15:08:33.839 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTHMHIVE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVE"}
[2025-11-19 15:08:33.844 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"a4UO_QLFsGcZBZDIG8y_BA","RequestId":"0HNH7KTHMHIVE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTHMHIVE"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:44.779 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:08:44.812 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:08:46.336 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
[2025-11-19 15:08:46.349 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.349 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
[2025-11-19 15:08:46.349 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.353 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.355 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
[2025-11-19 15:08:46.358 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.362 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.365 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
[2025-11-19 15:08:46.368 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.371 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.373 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
[2025-11-19 15:08:46.376 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.446 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.466 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:08:46.500 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"dfb275a3-592f-4edf-92b9-941d11106471","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7KTP3TM7N:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7KTP3TM7N"}
[2025-11-19 15:08:46.552 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"RCwUOGktwOmBx5nkXs68fQ","RequestId":"0HNH7KTP3TM7O:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7KTP3TM7O"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:08:46.579 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.591 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.594 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.596 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.599 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7KTP3TM7M"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:08:46.645 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.646 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.647 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.649 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.652 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.655 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.657 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.659 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.662 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.664 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.670 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:46.673 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:46.689 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.693 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.695 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.698 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.699 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.701 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
[2025-11-19 15:08:46.702 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.705 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7M:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7KTP3TM7M"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:08:46.707 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.717 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.721 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
[2025-11-19 15:08:46.726 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7KTP3TM7P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7KTP3TM7P"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:12:39.362 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:12:39.399 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:13:03.924 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L05SBIJ7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ7"}
[2025-11-19 15:13:03.937 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ7"}
[2025-11-19 15:13:03.940 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ7"}
[2025-11-19 15:13:03.942 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ7"}
[2025-11-19 15:13:03.944 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ7:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ7"}
[2025-11-19 15:13:08.934 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJA"}
[2025-11-19 15:13:08.934 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:08.934 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:08.937 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJA"}
[2025-11-19 15:13:08.939 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:08.941 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:08.943 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJA"}
[2025-11-19 15:13:08.945 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:08.947 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:08.949 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJA"}
[2025-11-19 15:13:08.951 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:08.953 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:09.006 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:09.021 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:13:09.029 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"yUlwLfh66JLNpbIz8bGvyQ","RequestId":"0HNH7L05SBIJA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJA"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:13:09.029 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"6e9bc336-dfae-4fa7-a907-710323f8d030","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L05SBIJ9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L05SBIJ9"}
[2025-11-19 15:13:09.059 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.088 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.092 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.094 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.099 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L05SBIJ8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:13:09.127 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.128 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.130 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.133 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.135 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.137 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.139 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.141 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.143 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.145 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.153 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:13:09.154 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:13:09.182 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.201 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.204 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.206 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.208 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.212 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.215 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
[2025-11-19 15:13:09.218 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.222 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJ8:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L05SBIJ8"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:13:09.224 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.256 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
[2025-11-19 15:13:09.274 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJB:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L05SBIJB"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:13:11.076 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJC"}
[2025-11-19 15:13:11.078 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJC"}
[2025-11-19 15:13:11.080 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJC"}
[2025-11-19 15:13:11.082 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJC"}
[2025-11-19 15:13:11.089 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"aOl4oT7gUebi6lcD_OBgkA","RequestId":"0HNH7L05SBIJC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:13:13.111 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJD"}
[2025-11-19 15:13:13.114 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJD"}
[2025-11-19 15:13:13.117 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJD"}
[2025-11-19 15:13:13.119 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L05SBIJD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJD"}
[2025-11-19 15:13:13.124 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"ZYYHvVH35PplG61VUvN8tg","RequestId":"0HNH7L05SBIJD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L05SBIJD"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:14:47.239 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:14:47.286 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:15:08.683 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L1B2BRQA:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQA"}
[2025-11-19 15:15:08.693 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQA:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQA"}
[2025-11-19 15:15:08.696 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQA:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQA"}
[2025-11-19 15:15:08.698 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQA:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQA"}
[2025-11-19 15:15:08.700 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQA:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQA"}
[2025-11-19 15:15:13.632 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.633 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.635 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.636 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQD"}
[2025-11-19 15:15:13.637 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.640 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.645 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQD"}
[2025-11-19 15:15:13.648 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.651 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.654 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQD"}
[2025-11-19 15:15:13.656 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.664 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQD"}
[2025-11-19 15:15:13.713 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.731 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:15:13.737 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"iVnX275uoQ2i3q2AFFRVkg","RequestId":"0HNH7L1B2BRQD:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQD"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:15:13.739 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"b24f644e-d0d4-47a8-94b4-c5f08898046d","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L1B2BRQB:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L1B2BRQB"}
[2025-11-19 15:15:13.780 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.786 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.788 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.790 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.794 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L1B2BRQC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:15:13.827 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.828 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.830 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.832 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.834 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.836 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.838 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.840 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.843 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.844 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.851 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method61(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:15:13.853 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:15:13.866 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.868 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.870 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.872 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.872 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.874 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.876 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
[2025-11-19 15:15:13.878 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.881 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQE:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L1B2BRQE"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method61(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:15:13.882 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.891 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
[2025-11-19 15:15:13.894 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQC:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L1B2BRQC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:15:15.803 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQF"}
[2025-11-19 15:15:15.805 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQF"}
[2025-11-19 15:15:15.808 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQF"}
[2025-11-19 15:15:15.811 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQF"}
[2025-11-19 15:15:15.819 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"b0acly_tKGxEkqIc-biKkw","RequestId":"0HNH7L1B2BRQF:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQF"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:15:17.845 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQG"}
[2025-11-19 15:15:17.849 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQG"}
[2025-11-19 15:15:17.851 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQG"}
[2025-11-19 15:15:17.852 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L1B2BRQG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQG"}
[2025-11-19 15:15:17.857 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"m-wyfhHvFFAROdxWu3z6Og","RequestId":"0HNH7L1B2BRQG:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L1B2BRQG"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:16:24.529 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:16:24.570 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:16:45.433 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L27SU241:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU241"}
[2025-11-19 15:16:45.447 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU241:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU241"}
[2025-11-19 15:16:45.451 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU241:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU241"}
[2025-11-19 15:16:45.454 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU241:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU241"}
[2025-11-19 15:16:45.457 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU241:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU241"}
[2025-11-19 15:16:56.652 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU242:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU242"}
[2025-11-19 15:16:56.658 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU242:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU242"}
[2025-11-19 15:16:56.663 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU242:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU242"}
[2025-11-19 15:16:56.665 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU242:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU242"}
[2025-11-19 15:17:08.627 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU243:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU243"}
[2025-11-19 15:17:08.634 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU243:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU243"}
[2025-11-19 15:17:08.636 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU243:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU243"}
[2025-11-19 15:17:08.638 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU243:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU243"}
[2025-11-19 15:18:01.890 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU246:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU246"}
[2025-11-19 15:18:01.892 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:01.892 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:01.893 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU246:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU246"}
[2025-11-19 15:18:01.897 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:01.899 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:01.901 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU246:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU246"}
[2025-11-19 15:18:01.903 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:01.905 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:01.908 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU246:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU246"}
[2025-11-19 15:18:01.911 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:01.914 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:01.965 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:01.983 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:18:01.988 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"HUbSe3emHpzA4aCiO3Byew","RequestId":"0HNH7L27SU246:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU246"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:01.990 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d9471ef9-91aa-40d0-b40f-10f775b6e977","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L27SU244:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L27SU244"}
[2025-11-19 15:18:02.018 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.021 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.025 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.028 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.032 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L27SU245"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:18:02.056 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.058 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.058 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.060 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.063 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.065 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.066 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.068 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.069 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.071 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.080 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method66(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:02.081 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:02.097 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.099 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.101 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.102 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.103 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.105 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.108 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
[2025-11-19 15:18:02.110 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.113 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU245:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L27SU245"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method66(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:02.114 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.123 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
[2025-11-19 15:18:02.129 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU247:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L27SU247"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:04.031 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU248:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU248"}
[2025-11-19 15:18:04.035 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU248:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU248"}
[2025-11-19 15:18:04.037 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU248:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU248"}
[2025-11-19 15:18:04.039 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU248:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU248"}
[2025-11-19 15:18:04.047 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"DykIuOvRRO_3bMPbufmNOg","RequestId":"0HNH7L27SU248:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU248"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:06.073 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU249:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU249"}
[2025-11-19 15:18:06.077 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU249:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU249"}
[2025-11-19 15:18:06.080 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU249:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU249"}
[2025-11-19 15:18:06.081 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU249:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU249"}
[2025-11-19 15:18:06.086 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"xgeHGbjpxMxReCfdkmnDlw","RequestId":"0HNH7L27SU249:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU249"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:08.114 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24A"}
[2025-11-19 15:18:08.117 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24A"}
[2025-11-19 15:18:08.119 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24A"}
[2025-11-19 15:18:08.121 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24A"}
[2025-11-19 15:18:08.126 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"1q3YmDK2fNt0PWIcIBYhEg","RequestId":"0HNH7L27SU24A:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24A"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:10.148 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24B"}
[2025-11-19 15:18:10.150 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24B"}
[2025-11-19 15:18:10.152 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24B"}
[2025-11-19 15:18:10.154 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L27SU24B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24B"}
[2025-11-19 15:18:10.158 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"9l8GWsaEBPu2Regz1gUc5Q","RequestId":"0HNH7L27SU24B:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L27SU24B"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:16.625 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:18:16.663 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:18:16.900 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.910 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.910 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:16.913 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.913 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822R"}
[2025-11-19 15:18:16.915 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:16.917 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.919 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822R"}
[2025-11-19 15:18:16.922 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:16.925 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.927 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822R"}
[2025-11-19 15:18:16.931 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:16.936 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822R"}
[2025-11-19 15:18:16.981 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:16.994 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:18:17.000 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"1f4c31dd-0d63-45f5-86d6-4b91f7230a94","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L335822O:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L335822O"}
[2025-11-19 15:18:17.001 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"MCgEl0XHpGkwyORiLyK7ig","RequestId":"0HNH7L335822R:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822R"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:18:17.042 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.044 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.047 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.049 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.053 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000004","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L335822N"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:18:17.078 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.079 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.081 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.083 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.085 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.087 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.088 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.090 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.093 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.095 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.103 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000006","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:17.105 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:17.117 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.120 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.122 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.123 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.124 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.127 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.129 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
[2025-11-19 15:18:17.131 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.134 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822N:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L335822N"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:17.135 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.146 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
[2025-11-19 15:18:17.151 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822P:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L335822P"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:18:19.053 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822S:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822S"}
[2025-11-19 15:18:19.061 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822S:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822S"}
[2025-11-19 15:18:19.063 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822S:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822S"}
[2025-11-19 15:18:19.065 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L335822S:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822S"}
[2025-11-19 15:18:19.072 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"W71t-1E5zRBGmBh1KhU_-w","RequestId":"0HNH7L335822S:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L335822S"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:19:20.257 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:19:20.293 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:19:46.502 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L3TRN0L4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L4"}
[2025-11-19 15:19:46.518 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L4"}
[2025-11-19 15:19:46.522 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L4"}
[2025-11-19 15:19:46.527 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L4"}
[2025-11-19 15:19:46.531 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L4:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L4"}
[2025-11-19 15:19:57.788 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L5:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L5"}
[2025-11-19 15:19:57.795 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L5:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L5"}
[2025-11-19 15:19:57.797 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L5:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L5"}
[2025-11-19 15:19:57.799 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L5:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L5"}
[2025-11-19 15:20:10.116 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L6"}
[2025-11-19 15:20:10.120 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L6"}
[2025-11-19 15:20:10.122 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L6"}
[2025-11-19 15:20:10.123 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L6"}
[2025-11-19 15:22:01.958 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:01.960 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L9"}
[2025-11-19 15:22:01.962 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:01.982 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:01.986 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L9"}
[2025-11-19 15:22:01.989 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:01.991 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:01.993 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L9"}
[2025-11-19 15:22:01.995 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:01.997 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.000 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L9"}
[2025-11-19 15:22:02.001 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:02.054 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:02.069 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method45(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:22:02.072 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"ZDqBSJ-H1IdL3pcz0Tib3w","RequestId":"0HNH7L3TRN0L9:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0L9"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:22:02.074 -05:00 INF] GetUserConversationsAsync for user 1000000003 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"4430a002-d23c-43cb-8653-da5138e4aec6","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L3TRN0L8:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L3TRN0L8"}
[2025-11-19 15:22:02.100 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.103 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.106 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.110 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.114 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000003","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L3TRN0L7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method45(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:22:02.141 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.143 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.144 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.146 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.149 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.151 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.154 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.155 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.157 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.159 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.166 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000005","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0L7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:22:02.168 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0LA"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:22:02.186 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.189 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.192 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.192 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.194 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.196 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.199 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
[2025-11-19 15:22:02.200 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.203 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LA:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L3TRN0LA"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method63(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:22:02.204 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.213 -05:00 INF] Usuario autenticado: José Santillan (ID: 1000000003) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
[2025-11-19 15:22:02.217 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0L7:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L3TRN0L7"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method69(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:22:04.114 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LB"}
[2025-11-19 15:22:04.116 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LB"}
[2025-11-19 15:22:04.118 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LB"}
[2025-11-19 15:22:04.120 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LB"}
[2025-11-19 15:22:04.128 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"xiPEOsD_Wyyw8c8_npAc0Q","RequestId":"0HNH7L3TRN0LB:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LB"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:22:06.149 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LC"}
[2025-11-19 15:22:06.152 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LC"}
[2025-11-19 15:22:06.155 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LC"}
[2025-11-19 15:22:06.157 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L3TRN0LC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LC"}
[2025-11-19 15:22:06.163 -05:00 ERR] Error when dispatching 'OnConnectedAsync' on hub. {"EventId":{"Id":1,"Name":"ErrorDispatchingHubEvent"},"SourceContext":"Microsoft.AspNetCore.SignalR.HubConnectionHandler","TransportConnectionId":"ffMSUJEF-ODSROKOhjGNyg","RequestId":"0HNH7L3TRN0LC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L3TRN0LC"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method53(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubActivator`1.Create()
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.Internal.DefaultHubDispatcher`1.OnConnectedAsync(HubConnectionContext connection)
   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)
[2025-11-19 15:23:12.913 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:23:12.950 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:23:28.078 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.101 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JSANCHEZ","cUsuarioContra":"jeysson12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.105 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.107 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.111 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.115 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:28.147 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:23:33.538 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JSANCHEZ","cUsuarioContra":"jeysson12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:33.541 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:33.544 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:33.550 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:33.554 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
[2025-11-19 15:23:33.557 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L5VSOGUQ:00000004","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L5VSOGUQ"}
System.InvalidOperationException: Unable to resolve service for type 'Supabase.Client' while attempting to activate 'ChatModularMicroservice.Infrastructure.Repositories.AppRegistroRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method44(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 59
[2025-11-19 15:25:52.614 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 15:25:52.653 -05:00 INF] Servidor escuchando en: http://localhost:5405;http://localhost:5406 {}
[2025-11-19 15:26:07.054 -05:00 WRN] Failed to determine the https port for redirect. {"EventId":{"Id":3,"Name":"FailedToDeterminePort"},"SourceContext":"Microsoft.AspNetCore.HttpsPolicy.HttpsRedirectionMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:07.078 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JSANCHEZ","cUsuarioContra":"jeysson12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:07.086 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:07.088 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:07.091 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:07.093 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:08.941 -05:00 INF] Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:08.954 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.245 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.482 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.492 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.760 -05:00 INF] GetByUsernameAsync: Usuario encontrado, rol asignado: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.765 -05:00 INF] GetByUserCodeAsync: Encontrado por Username, rol: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:09.769 -05:00 INF] Resultado búsqueda usuario: encontrado=true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.057 -05:00 INF] Validación de contraseña con BCrypt para usuario JSANCHEZ: true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.064 -05:00 INF] Generating access token for user 1000000001 with role: USER {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.084 -05:00 INF] Generated token with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.585 -05:00 INF] Login exitoso para usuario: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T5:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.718 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.718 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.718 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.720 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.722 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.724 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.726 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.728 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.731 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.732 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.734 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000005","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.737 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.757 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.770 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"bbb41397-9c16-4f18-bec9-b91bcba7415d","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T6:00000001","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6T6"}
[2025-11-19 15:26:10.785 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hSVdDjGI1l6S_G-y9urQtQ","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.789 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.791 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.791 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763583970, exp:1763843170, iat:1763583970, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hSVdDjGI1l6S_G-y9urQtQ","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.793 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.796 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.800 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hSVdDjGI1l6S_G-y9urQtQ","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6T7"}
[2025-11-19 15:26:10.803 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.813 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.810 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection hSVdDjGI1l6S_G-y9urQtQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hSVdDjGI1l6S_G-y9urQtQ","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub"}
[2025-11-19 15:26:10.807 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.817 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.829 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.834 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.837 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000007","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T5"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:26:10.841 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T8"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method215(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:26:10.875 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.877 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.878 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.880 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.882 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.883 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.885 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.887 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
[2025-11-19 15:26:10.889 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.891 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T8:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6T8"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:26:10.893 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
[2025-11-19 15:26:10.936 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T5:00000008","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6T5"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.GetCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method215(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:26:24.680 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JSANCHEZ","cUsuarioContra":"jeysson12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:24.684 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:24.686 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:24.688 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:24.690 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.109 -05:00 INF] Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.115 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.338 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.559 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.565 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.779 -05:00 INF] GetByUsernameAsync: Usuario encontrado, rol asignado: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.785 -05:00 INF] GetByUserCodeAsync: Encontrado por Username, rol: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.787 -05:00 INF] Resultado búsqueda usuario: encontrado=true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.924 -05:00 INF] Validación de contraseña con BCrypt para usuario JSANCHEZ: true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.929 -05:00 INF] Generating access token for user 1000000001 with role: USER {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:25.933 -05:00 INF] Generated token with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:26:26.389 -05:00 INF] Login exitoso para usuario: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"27ee690b-7306-4f5f-aaa4-22bc3e2a087f","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6T9:00000001","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7L7F8S6T9"}
[2025-11-19 15:42:17.065 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection hSVdDjGI1l6S_G-y9urQtQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"hSVdDjGI1l6S_G-y9urQtQ","RequestId":"0HNH7L7F8S6T7:00000001","RequestPath":"/chathub"}
[2025-11-19 15:42:17.323 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.334 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.326 -05:00 INF] Verificando ruta: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.333 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.337 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.340 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.342 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.346 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.349 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.351 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.353 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.355 -05:00 INF] Ruta pública detectada: /api/v1/aplicaciones/SICOM_CHAT_2024/configuration {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000002","RequestPath":"/api/v1/aplicaciones/SICOM_CHAT_2024/configuration","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.357 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.359 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"bbb41397-9c16-4f18-bec9-b91bcba7415d","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7L7F8S6TA:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.378 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.380 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.381 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"OnfbKA-Gc-gt8V7C0rK-DQ","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.382 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.384 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.389 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763583970, exp:1763843170, iat:1763583970, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"OnfbKA-Gc-gt8V7C0rK-DQ","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.391 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.395 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.399 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"OnfbKA-Gc-gt8V7C0rK-DQ","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7L7F8S6TC"}
[2025-11-19 15:42:17.402 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.404 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.407 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection OnfbKA-Gc-gt8V7C0rK-DQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"OnfbKA-Gc-gt8V7C0rK-DQ","RequestId":"0HNH7L7F8S6TC:00000001","RequestPath":"/chathub"}
[2025-11-19 15:42:17.409 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.411 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.416 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:42:17.418 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000005","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method215(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:42:17.431 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.433 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.436 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.437 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.438 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.440 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.441 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
[2025-11-19 15:42:17.443 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.445 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TB:00000004","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7L7F8S6TB"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 15:42:17.446 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.454 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
[2025-11-19 15:42:17.457 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7L7F8S6TA:00000006","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7L7F8S6TA"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Shared.Configs.SupabaseConfig' while attempting to activate 'ChatModularMicroservice.Infrastructure.ContactoSupabaseRepository'.
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateArgumentCallSites(ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain, ParameterInfo[] parameters, Boolean throwIfCallSiteNotFound)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateConstructorCallSite(ResultCache lifetime, ServiceIdentifier serviceIdentifier, Type implementationType, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.TryCreateExact(ServiceDescriptor descriptor, ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain, Int32 slot)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteFactory.CreateCallSite(ServiceIdentifier serviceIdentifier, CallSiteChain callSiteChain)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.CreateServiceAccessor(ServiceIdentifier serviceIdentifier)
   at System.Collections.Concurrent.ConcurrentDictionary`2.GetOrAdd(TKey key, Func`2 valueFactory)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method215(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in D:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
