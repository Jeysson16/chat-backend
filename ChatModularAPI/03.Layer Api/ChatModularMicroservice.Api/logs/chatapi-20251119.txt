[2025-11-19 07:15:56.361 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 07:15:56.401 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 07:22:44.543 -05:00 INF] HTTP Request - Method: POST, Path: /api/v1/auth/login, Body: {"cUsuarioCodigo":"JSANCHEZ","cUsuarioContra":"jeysson12345","bRecordarme":true,"cTokenAcceso":"AT_6cbeb6faba662bffb1e9b0cdc3a96670","cTokenSecreto":"ST_0b2c702f3fd200f0fc9ddb02624a21bc9d8be4fa96672504","cPerJurCodigo":"DEFAULT"} {"SourceContext":"ChatModularMicroservice.Api.Middleware.RequestBodyMiddleware","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:44.558 -05:00 INF] Verificando ruta: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:44.563 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:44.565 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:44.568 -05:00 INF] Ruta pública detectada: /api/v1/auth/login {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:47.471 -05:00 INF] Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:47.477 -05:00 INF] GetByUserCodeAsync: Buscando usuario por código: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:47.718 -05:00 INF] GetByEmailAsync: Buscando usuario por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:47.900 -05:00 INF] GetByEmailAsync: Usuario no encontrado por email: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:47.906 -05:00 INF] GetByUsernameAsync: Buscando usuario por username: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.096 -05:00 INF] GetByUsernameAsync: Usuario encontrado, rol asignado: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.102 -05:00 INF] GetByUserCodeAsync: Encontrado por Username, rol: USER {"SourceContext":"ChatModularMicroservice.Infrastructure.UsuarioRepository","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.105 -05:00 INF] Resultado búsqueda usuario: encontrado=true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.381 -05:00 INF] Validación de contraseña con BCrypt para usuario JSANCHEZ: true {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.390 -05:00 INF] Generating access token for user 1000000001 with role: USER {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.463 -05:00 INF] Generated token with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024 {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:48.868 -05:00 INF] Login exitoso para usuario: JSANCHEZ {"SourceContext":"ChatModularMicroservice.Domain.AuthService","ActionId":"d0cc38ed-be6e-4fbb-9737-fab3ae3848ee","ActionName":"ChatModularMicroservice.Api.Controllers.AuthController.Login (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000002","RequestPath":"/api/v1/auth/login","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.002 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.005 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.005 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.010 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.013 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.014 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.015 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.017 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.019 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.022 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.030 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.033 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.036 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.038 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.043 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.045 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.053 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.053 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.053 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.063 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJR"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IContactoService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.ContactoController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method197(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 07:22:49.064 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJS"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IContactoService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.ContactoController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 07:22:49.066 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"7145bef7-a039-41fd-b5f2-a13c4e87789d","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7CPBPSNJP:00000004","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7CPBPSNJP"}
[2025-11-19 07:22:49.078 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ra_Mrp35azOqjJRkFlv0rQ","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.117 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ra_Mrp35azOqjJRkFlv0rQ","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.118 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.121 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.120 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ra_Mrp35azOqjJRkFlv0rQ","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7CPBPSNJQ"}
[2025-11-19 07:22:49.121 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.123 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.126 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection ra_Mrp35azOqjJRkFlv0rQ {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ra_Mrp35azOqjJRkFlv0rQ","RequestId":"0HNH7CPBPSNJQ:00000001","RequestPath":"/chathub"}
[2025-11-19 07:22:49.127 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.128 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.132 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.134 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.138 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
[2025-11-19 07:22:49.140 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
[2025-11-19 07:22:49.143 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJR:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7CPBPSNJR"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IContactoService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.ContactoController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method207(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 07:22:49.145 -05:00 ERR] Error en validación de autenticación {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7CPBPSNJS:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7CPBPSNJS"}
System.InvalidOperationException: Unable to resolve service for type 'ChatModularMicroservice.Domain.IContactoService' while attempting to activate 'ChatModularMicroservice.Api.Controllers.ContactoController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method197(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware.InvokeAsync(HttpContext context) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Middleware\AuthValidationMiddleware.cs:line 113
[2025-11-19 07:53:46.112 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 07:53:46.151 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 08:00:34.672 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.674 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.675 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
[2025-11-19 08:00:34.675 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
[2025-11-19 08:00:34.677 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.678 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.680 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
[2025-11-19 08:00:34.681 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
[2025-11-19 08:00:34.683 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.684 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.686 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
[2025-11-19 08:00:34.688 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
[2025-11-19 08:00:34.690 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.691 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.693 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
[2025-11-19 08:00:34.694 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
[2025-11-19 08:00:34.745 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.745 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
[2025-11-19 08:00:34.745 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
[2025-11-19 08:00:34.773 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"4f567561-b213-4cf5-865f-889a6284b754","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DEGD0V9S:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DEGD0V9S"}
[2025-11-19 08:00:34.776 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"JRTI3skT8AJmVUOawRsWQg","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.780 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"JRTI3skT8AJmVUOawRsWQg","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.783 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"JRTI3skT8AJmVUOawRsWQg","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DEGD0V9T"}
[2025-11-19 08:00:34.787 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection JRTI3skT8AJmVUOawRsWQg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"JRTI3skT8AJmVUOawRsWQg","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub"}
[2025-11-19 08:00:34.953 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"eb5d0ce7-2362-4e9a-ab9a-ee12d77d6552","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 298
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:379f2b75-de39-40be-9160-c20971cda99d
Error Number:2812,State:62,Class:16
[2025-11-19 08:00:34.953 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"a9c5ee8d-8eb6-4e40-b97b-6ecf7edb749c","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 298
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:78f4bec9-bce3-4b5a-ab2c-c4ff578d1e02
Error Number:2812,State:62,Class:16
[2025-11-19 08:00:35.045 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"eb5d0ce7-2362-4e9a-ab9a-ee12d77d6552","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DEGD0V9U:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DEGD0V9U"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 298
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:379f2b75-de39-40be-9160-c20971cda99d
Error Number:2812,State:62,Class:16
[2025-11-19 08:00:35.051 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"a9c5ee8d-8eb6-4e40-b97b-6ecf7edb749c","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DEGD0V9V:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DEGD0V9V"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactosPorUsuario'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 298
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:78f4bec9-bce3-4b5a-ab2c-c4ff578d1e02
Error Number:2812,State:62,Class:16
[2025-11-19 08:10:41.852 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection JRTI3skT8AJmVUOawRsWQg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"JRTI3skT8AJmVUOawRsWQg","RequestId":"0HNH7DEGD0V9T:00000001","RequestPath":"/chathub"}
[2025-11-19 08:14:05.524 -05:00 INF] Iniciando aplicación ChatModular API {}
[2025-11-19 08:14:05.556 -05:00 INF] Servidor escuchando en: http://127.0.0.1:5405;http://localhost:5406 {}
[2025-11-19 08:14:19.007 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.009 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.009 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
[2025-11-19 08:14:19.009 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
[2025-11-19 08:14:19.011 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.012 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.014 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
[2025-11-19 08:14:19.016 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
[2025-11-19 08:14:19.018 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.020 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.021 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
[2025-11-19 08:14:19.023 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
[2025-11-19 08:14:19.026 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.028 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.030 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
[2025-11-19 08:14:19.032 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
[2025-11-19 08:14:19.079 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
[2025-11-19 08:14:19.079 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.079 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
[2025-11-19 08:14:19.112 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2BT:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2BT"}
[2025-11-19 08:14:19.119 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"5VSeV2OHKEKR8s_LkPN-Rw","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.123 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"5VSeV2OHKEKR8s_LkPN-Rw","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.126 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"5VSeV2OHKEKR8s_LkPN-Rw","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2BU"}
[2025-11-19 08:14:19.130 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection 5VSeV2OHKEKR8s_LkPN-Rw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"5VSeV2OHKEKR8s_LkPN-Rw","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub"}
[2025-11-19 08:14:19.273 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:f0e44103-eb2d-4f89-bbf7-ee646ae55690
Error Number:2812,State:62,Class:16
[2025-11-19 08:14:19.273 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:57b895cb-1015-4e59-8297-9153cebd9a77
Error Number:2812,State:62,Class:16
[2025-11-19 08:14:19.306 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2BV:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2BV"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:f0e44103-eb2d-4f89-bbf7-ee646ae55690
Error Number:2812,State:62,Class:16
[2025-11-19 08:14:19.312 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C0:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C0"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:57b895cb-1015-4e59-8297-9153cebd9a77
Error Number:2812,State:62,Class:16
[2025-11-19 08:19:36.486 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection 5VSeV2OHKEKR8s_LkPN-Rw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"5VSeV2OHKEKR8s_LkPN-Rw","RequestId":"0HNH7DM62H2BU:00000001","RequestPath":"/chathub"}
[2025-11-19 08:19:36.759 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.761 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.762 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.763 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.765 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.766 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.768 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.770 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.771 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.771 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
[2025-11-19 08:19:36.772 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
[2025-11-19 08:19:36.775 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C1:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C1"}
[2025-11-19 08:19:36.777 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
[2025-11-19 08:19:36.778 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
[2025-11-19 08:19:36.782 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
[2025-11-19 08:19:36.784 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
[2025-11-19 08:19:36.786 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
[2025-11-19 08:19:36.787 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
[2025-11-19 08:19:36.789 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
[2025-11-19 08:19:36.791 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
[2025-11-19 08:19:36.799 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:dd047626-5c65-4873-8a50-244061a491fe
Error Number:2812,State:62,Class:16
[2025-11-19 08:19:36.802 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:a9440a74-0e19-4c1f-bf7e-012e0c2a03b1
Error Number:2812,State:62,Class:16
[2025-11-19 08:19:36.806 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C3:00000003","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C3"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:dd047626-5c65-4873-8a50-244061a491fe
Error Number:2812,State:62,Class:16
[2025-11-19 08:19:36.811 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C4:00000001","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C4"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:a9440a74-0e19-4c1f-bf7e-012e0c2a03b1
Error Number:2812,State:62,Class:16
[2025-11-19 08:19:36.833 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ieRSZa851AjKsedh_0wfsA","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.837 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ieRSZa851AjKsedh_0wfsA","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.840 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ieRSZa851AjKsedh_0wfsA","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C2"}
[2025-11-19 08:19:36.843 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection ieRSZa851AjKsedh_0wfsA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ieRSZa851AjKsedh_0wfsA","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub"}
[2025-11-19 08:35:48.332 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection ieRSZa851AjKsedh_0wfsA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"ieRSZa851AjKsedh_0wfsA","RequestId":"0HNH7DM62H2C2:00000001","RequestPath":"/chathub"}
[2025-11-19 08:35:48.620 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.621 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.622 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.624 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.625 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.627 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.629 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.632 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.636 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
[2025-11-19 08:35:48.637 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.637 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
[2025-11-19 08:35:48.639 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
[2025-11-19 08:35:48.641 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C5:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C5"}
[2025-11-19 08:35:48.642 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
[2025-11-19 08:35:48.644 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
[2025-11-19 08:35:48.648 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
[2025-11-19 08:35:48.650 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
[2025-11-19 08:35:48.652 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
[2025-11-19 08:35:48.661 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
[2025-11-19 08:35:48.663 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
[2025-11-19 08:35:48.670 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:4ad7638b-ccb9-4343-9ada-4e01a9286c01
Error Number:2812,State:62,Class:16
[2025-11-19 08:35:48.672 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:ebe48a46-0f14-47b3-b000-5506afe1c1f0
Error Number:2812,State:62,Class:16
[2025-11-19 08:35:48.676 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C8:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2C8"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:4ad7638b-ccb9-4343-9ada-4e01a9286c01
Error Number:2812,State:62,Class:16
[2025-11-19 08:35:48.680 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C7:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2C7"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:ebe48a46-0f14-47b3-b000-5506afe1c1f0
Error Number:2812,State:62,Class:16
[2025-11-19 08:35:48.692 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"EBAdIP0Va7sebEjAieGSyw","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.695 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"EBAdIP0Va7sebEjAieGSyw","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.698 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"EBAdIP0Va7sebEjAieGSyw","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2C6"}
[2025-11-19 08:35:48.701 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection EBAdIP0Va7sebEjAieGSyw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"EBAdIP0Va7sebEjAieGSyw","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub"}
[2025-11-19 09:03:24.119 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection EBAdIP0Va7sebEjAieGSyw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"EBAdIP0Va7sebEjAieGSyw","RequestId":"0HNH7DM62H2C6:00000001","RequestPath":"/chathub"}
[2025-11-19 09:03:24.415 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.415 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.416 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.418 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.420 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.422 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.423 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.422 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
[2025-11-19 09:03:24.425 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.426 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.427 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
[2025-11-19 09:03:24.428 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
[2025-11-19 09:03:24.431 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2C9:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2C9"}
[2025-11-19 09:03:24.433 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
[2025-11-19 09:03:24.435 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
[2025-11-19 09:03:24.438 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
[2025-11-19 09:03:24.440 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
[2025-11-19 09:03:24.441 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
[2025-11-19 09:03:24.444 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
[2025-11-19 09:03:24.445 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
[2025-11-19 09:03:24.452 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:f481e001-f454-4bbe-841a-98a45d7eed90
Error Number:2812,State:62,Class:16
[2025-11-19 09:03:24.454 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:bcd4711f-7099-4415-93e0-118041006c8d
Error Number:2812,State:62,Class:16
[2025-11-19 09:03:24.458 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CB:00000002","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CB"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:f481e001-f454-4bbe-841a-98a45d7eed90
Error Number:2812,State:62,Class:16
[2025-11-19 09:03:24.462 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CC:00000002","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CC"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:bcd4711f-7099-4415-93e0-118041006c8d
Error Number:2812,State:62,Class:16
[2025-11-19 09:03:24.480 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9kHQ0hO7GR5bXIOTveR6kg","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.483 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9kHQ0hO7GR5bXIOTveR6kg","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.486 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9kHQ0hO7GR5bXIOTveR6kg","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CA"}
[2025-11-19 09:03:24.488 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection 9kHQ0hO7GR5bXIOTveR6kg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9kHQ0hO7GR5bXIOTveR6kg","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub"}
[2025-11-19 09:16:19.462 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection 9kHQ0hO7GR5bXIOTveR6kg {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"9kHQ0hO7GR5bXIOTveR6kg","RequestId":"0HNH7DM62H2CA:00000001","RequestPath":"/chathub"}
[2025-11-19 09:16:19.749 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.751 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.752 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.754 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.756 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.759 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.759 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
[2025-11-19 09:16:19.761 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
[2025-11-19 09:16:19.761 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.763 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.764 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
[2025-11-19 09:16:19.766 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
[2025-11-19 09:16:19.770 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.772 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
[2025-11-19 09:16:19.774 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
[2025-11-19 09:16:19.776 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CD:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CD"}
[2025-11-19 09:16:19.777 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
[2025-11-19 09:16:19.779 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
[2025-11-19 09:16:19.783 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
[2025-11-19 09:16:19.785 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
[2025-11-19 09:16:19.791 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:de00ce79-2d83-492c-b85b-bc8a666e5aa1
Error Number:2812,State:62,Class:16
[2025-11-19 09:16:19.793 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:cf73c655-75d8-409b-add2-4a4c728b6c23
Error Number:2812,State:62,Class:16
[2025-11-19 09:16:19.797 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CG:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CG"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:de00ce79-2d83-492c-b85b-bc8a666e5aa1
Error Number:2812,State:62,Class:16
[2025-11-19 09:16:19.802 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CF:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CF"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:cf73c655-75d8-409b-add2-4a4c728b6c23
Error Number:2812,State:62,Class:16
[2025-11-19 09:16:19.813 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"y5s0JM76pooi5GEmQPDYxw","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.816 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"y5s0JM76pooi5GEmQPDYxw","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.818 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"y5s0JM76pooi5GEmQPDYxw","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CE"}
[2025-11-19 09:16:19.820 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection y5s0JM76pooi5GEmQPDYxw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"y5s0JM76pooi5GEmQPDYxw","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub"}
[2025-11-19 09:26:45.843 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection y5s0JM76pooi5GEmQPDYxw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"y5s0JM76pooi5GEmQPDYxw","RequestId":"0HNH7DM62H2CE:00000001","RequestPath":"/chathub"}
[2025-11-19 09:26:46.184 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.185 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.186 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.187 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.190 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.192 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.194 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.197 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.197 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
[2025-11-19 09:26:46.198 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
[2025-11-19 09:26:46.199 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.202 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
[2025-11-19 09:26:46.204 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
[2025-11-19 09:26:46.206 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CH:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CH"}
[2025-11-19 09:26:46.207 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
[2025-11-19 09:26:46.209 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
[2025-11-19 09:26:46.214 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
[2025-11-19 09:26:46.216 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
[2025-11-19 09:26:46.217 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
[2025-11-19 09:26:46.219 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
[2025-11-19 09:26:46.223 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:de00ce79-2d83-492c-b85b-bc8a666e5aa1
Error Number:2812,State:62,Class:16
[2025-11-19 09:26:46.224 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:07c9f046-e71f-4c8b-a1ea-459b308aa7e6
Error Number:2812,State:62,Class:16
[2025-11-19 09:26:46.228 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CK:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CK"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:de00ce79-2d83-492c-b85b-bc8a666e5aa1
Error Number:2812,State:62,Class:16
[2025-11-19 09:26:46.234 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CJ:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CJ"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:07c9f046-e71f-4c8b-a1ea-459b308aa7e6
Error Number:2812,State:62,Class:16
[2025-11-19 09:26:46.261 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YmeRxXTIGvmogC_CETIqEA","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.263 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YmeRxXTIGvmogC_CETIqEA","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.266 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YmeRxXTIGvmogC_CETIqEA","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CI"}
[2025-11-19 09:26:46.268 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection YmeRxXTIGvmogC_CETIqEA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YmeRxXTIGvmogC_CETIqEA","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub"}
[2025-11-19 09:33:24.196 -05:00 INF] User Jeysson Sánchez Rodríguez disconnected from app SICOM_CHAT_2024 with connection YmeRxXTIGvmogC_CETIqEA {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"YmeRxXTIGvmogC_CETIqEA","RequestId":"0HNH7DM62H2CI:00000001","RequestPath":"/chathub"}
[2025-11-19 09:33:24.618 -05:00 INF] Verificando ruta: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.619 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.622 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.622 -05:00 INF] Verificando ruta: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.638 -05:00 INF] Verificando ruta: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
[2025-11-19 09:33:24.638 -05:00 INF] Ruta privada detectada: /api/chat/conversations {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.640 -05:00 INF] Verificando ruta: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
[2025-11-19 09:33:24.641 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.643 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
[2025-11-19 09:33:24.645 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.647 -05:00 INF] Rutas públicas configuradas: /, /api/v1/auth/login, /api/v1/auth/register, /api/v1/auth/status, /api/v1/auth/generar-tokens-aplicacion, /api/v1/auth/validar-access-token, /api/v1/auth/renovar-tokens, /api/v1/auth/revocar-tokens, /api/v1/auth/tokens-aplicacion, /api/v1/aplicaciones, /swagger, /swagger/index.html, /swagger/v1/swagger.json, /api/docs, /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
[2025-11-19 09:33:24.649 -05:00 INF] ¿Es ruta pública? true {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.651 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
[2025-11-19 09:33:24.654 -05:00 INF] GetUserConversationsAsync for user 1000000001 in app SICOM_CHAT_2024 perJur DEFAULT {"SourceContext":"ChatModularMicroservice.Domain.ChatService","ActionId":"d09b81d1-1692-4a42-9a70-6187dcb926de","ActionName":"ChatModularMicroservice.Api.Controllers.ChatModernController.GetMyConversations (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CL:00000002","RequestPath":"/api/chat/conversations","ConnectionId":"0HNH7DM62H2CL"}
[2025-11-19 09:33:24.655 -05:00 INF] ¿Es ruta pública? false {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
[2025-11-19 09:33:24.657 -05:00 INF] Ruta pública detectada: /chathub {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.658 -05:00 INF] Ruta privada detectada: /api/v1/contactos/my-contacts {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
[2025-11-19 09:33:24.663 -05:00 INF] Ruta privada detectada: /api/v1/contactos/stats {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
[2025-11-19 09:33:24.666 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
[2025-11-19 09:33:24.668 -05:00 INF] Usuario autenticado: Jeysson Sánchez Rodríguez (ID: 1000000001) {"SourceContext":"ChatModularMicroservice.Api.Middleware.AuthValidationMiddleware","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
[2025-11-19 09:33:24.674 -05:00 ERR] Error al obtener contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:a1f6a3fa-04be-4b5d-9241-92224f650c95
Error Number:2812,State:62,Class:16
[2025-11-19 09:33:24.675 -05:00 ERR] Error al obtener estadísticas de contactos del usuario 1000000001 {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:5ad4e1ed-5fa4-4cc6-bd2c-0a5303000618
Error Number:2812,State:62,Class:16
[2025-11-19 09:33:24.679 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"81ffda68-ae44-4d02-a597-1c211ce21bec","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CO:00000001","RequestPath":"/api/v1/contactos/my-contacts","ConnectionId":"0HNH7DM62H2CO"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetMisContactos(String estado) in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 171
ClientConnectionId:a1f6a3fa-04be-4b5d-9241-92224f650c95
Error Number:2812,State:62,Class:16
[2025-11-19 09:33:24.684 -05:00 ERR] Error en controlador: No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'. {"SourceContext":"ChatModularMicroservice.Api.Controllers.ContactoController","ActionId":"636cee7f-a81f-4d05-a5b3-21b8dfd380cd","ActionName":"ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos (ChatModularMicroservice.Api)","RequestId":"0HNH7DM62H2CN:00000003","RequestPath":"/api/v1/contactos/stats","ConnectionId":"0HNH7DM62H2CN"}
Microsoft.Data.SqlClient.SqlException (0x80131904): No se encontró el procedimiento almacenado 'USP_Contactos_ListarContactos'.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__195_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Dapper.SqlMapper.QueryAsync[T](IDbConnection cnn, Type effectiveType, CommandDefinition command) in /_/Dapper/SqlMapper.Async.cs:line 434
   at ChatModularMicroservice.Infrastructure.BaseRepository.LoadData[T](String storedProcedure, DynamicParameters parameters) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\BaseRepository.cs:line 30
   at ChatModularMicroservice.Infrastructure.ContactoRepository.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\01.Layer Infrastructure\ChatModularMicroservice.Infrastructure\ContactoRepository.cs:line 299
   at ChatModularMicroservice.Domain.ContactoService.ListarContactosPorUsuarioAsync(String usuarioId, String empresaId, String aplicacionId, String estado) in d:\Chat\ChatBackend\ChatModularAPI\02.Layer Domain\ChatModularMicroservice.Domain\ContactoService.cs:line 46
   at ChatModularMicroservice.Api.Controllers.ContactoController.GetEstadisticasContactos() in d:\Chat\ChatBackend\ChatModularAPI\03.Layer Api\ChatModularMicroservice.Api\Controllers\ContactoController.cs:line 327
ClientConnectionId:5ad4e1ed-5fa4-4cc6-bd2c-0a5303000618
Error Number:2812,State:62,Class:16
[2025-11-19 09:33:24.697 -05:00 INF] SignalR connection attempt - AppCode: SICOM_CHAT_2024, HasAuthHeader: true {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7RfhWJ_K5aCl5vNcezWRUw","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.699 -05:00 INF] Token validated with claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier:1000000001, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress:jesanchezr@ucvvirtual.edu.pe, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name:Jeysson Sánchez Rodríguez, http://schemas.microsoft.com/ws/2008/06/identity/claims/role:USER, username:JSANCHEZ, per_codigo:627b8d95-e04b-44c4-8fa6-ccdf14ae1992, per_jur_codigo:DEFAULT, user_id:1000000001, app_code:SICOM_CHAT_2024, nbf:1763554968, exp:1763814168, iat:1763554968, iss:ChatModularAPI, aud:ChatModularAPI {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7RfhWJ_K5aCl5vNcezWRUw","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.702 -05:00 INF] Extracted user info - UserId: 1000000001, UserName: Jeysson Sánchez Rodríguez {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7RfhWJ_K5aCl5vNcezWRUw","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub","ConnectionId":"0HNH7DM62H2CM"}
[2025-11-19 09:33:24.704 -05:00 INF] User Jeysson Sánchez Rodríguez connected to app SICOM_CHAT_2024 with connection 7RfhWJ_K5aCl5vNcezWRUw {"SourceContext":"ChatModularMicroservice.Api.Hubs.ChatHub","TransportConnectionId":"7RfhWJ_K5aCl5vNcezWRUw","RequestId":"0HNH7DM62H2CM:00000001","RequestPath":"/chathub"}
